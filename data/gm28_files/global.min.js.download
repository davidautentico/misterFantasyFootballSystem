videoreward=!0;var newStorePaypal=!0,newStoreCredits=!0,newStoreIap=!0,ironSrcWatchToken="",ironVRPlacement=void 0===_cfg.video_reward_placement?"Home_Screen":_cfg.video_reward_placement,onVRCloseQueue=[],cssColors={fg_primary:window.getComputedStyle(document.documentElement).getPropertyValue("--fg-primary"),fg_secondary:window.getComputedStyle(document.documentElement).getPropertyValue("--fg-secondary"),bg_primary:window.getComputedStyle(document.documentElement).getPropertyValue("--bg-primary"),bg_secondary:window.getComputedStyle(document.documentElement).getPropertyValue("--bg-secondary"),bg_tertiary:window.getComputedStyle(document.documentElement).getPropertyValue("--bg-tertiary"),invert:window.getComputedStyle(document.documentElement).getPropertyValue("--invert"),blue_dark:window.getComputedStyle(document.documentElement).getPropertyValue("--blue-dark"),blue_medium:window.getComputedStyle(document.documentElement).getPropertyValue("--blue-medium"),green_dark_extra:window.getComputedStyle(document.documentElement).getPropertyValue("--green-dark-extra"),green_dark:window.getComputedStyle(document.documentElement).getPropertyValue("--green-dark"),green_medium:window.getComputedStyle(document.documentElement).getPropertyValue("--green-medium"),yellow_dark:window.getComputedStyle(document.documentElement).getPropertyValue("--yellow-dark"),yellow_medium:window.getComputedStyle(document.documentElement).getPropertyValue("--yellow-medium"),red_dark:window.getComputedStyle(document.documentElement).getPropertyValue("--red-dark"),red_medium:window.getComputedStyle(document.documentElement).getPropertyValue("--red-medium"),orange_dark:window.getComputedStyle(document.documentElement).getPropertyValue("--orange-dark"),orange_medium:window.getComputedStyle(document.documentElement).getPropertyValue("--orange-medium"),activeColor:window.getComputedStyle(document.documentElement).getPropertyValue("--activeColor"),activeMono:window.getComputedStyle(document.documentElement).getPropertyValue("--activeMono")};function sprintf(e){var t=Array.prototype.slice.call(arguments,1),a=0;return e.replace("%%","%").replace(/%s/g,function(){return t[a++]})}function bind(e,t){window[e]=t,$('[data-bind="'+e+'"]').text(t)}_cfg.i18n=JSON.parse(_cfg.i18n),i18next.use(i18nextICU).init({lng:_cfg.language.code,debug:!0}).then(function(){i18next.addResourceBundle(_cfg.language.code,"translation",_cfg.i18n,!0,!0)}),$.ajaxSetup({type:"POST",headers:{"X-Auth":_cfg.auth},timeout:3e4,error:function(e){toast(void 0!==e.responseJSON&&void 0!==e.responseJSON.msg?e.responseJSON.msg:msg.error,"red")}});var msg={error:_("¡Ups! Algo ha fallado. Revisa la acción y vuelve a intentarlo")},hash=window.location.hash,popup=!1,on_tap_start="ontouchstart"in document?"touchstart":"mouseenter",on_tap_end="ontouchend"in document?"touchend touchmove touchcancel":"mouseleave",testUsers=[1,2,513,1111,5378,107117,554541,599156],popup_content;function isTestUser(){return-1!=testUsers.indexOf(_cfg.user.id)}function popup_show(e,t,a,o){$("#popup-content").html(t);(-1<["clause-set","credits-get","credits-redeem","formation","rescind","settings","substitution","pools-info"].indexOf(e)||$(t).find(".btn-credits").length)&&showStoreFloatingBtn(),popup||(popup=!0,$("#popup-content").css("max-height",.9*$(window).height()+"px"),$("html").addClass("popup-open").css("overflow","hidden"),slideout&&slideout.disableTouch(),$("#overlay").css("display","flex").width(),$("#overlay").addClass("show"),history.pushState(null,null,null)),a&&a.removeClass("loading"),"function"==typeof window["open_"+e.replace(/-|\//g,"_")]&&window["open_"+e.replace(/-|\//g,"_")](o),attachDragToScroll()}function popup_twig(t,a,o,n){a.cfg=_cfg,"undefined"!=typeof data&&(a.data=data);var r,e=t.replace(/\//g,"-");$("#twig-"+e).length?(r=twig({data:$("#twig-"+e).text()}).render(a),popup_show(t,r,o,n)):template=twig({href:_cfg.paths.views+"/ajax/"+t+".twig?"+_cfg.twig,async:!0,load:function(e){r=e.render(a),popup_show(t,r,o,n)}})}function popup_open(t,a,o,n,e){o&&o.addClass("loading"),e?$.ajax({url:"ajax/"+e,data:o.get(0).dataset,success:function(e){a.pre=e.data,popup_twig(t,a,o,n)}}):popup_twig(t,a,o,n)}function fetch_html_api(e){var t="/api2/"+e;return console.log("Fetching api2: ",t),fetch(t,{method:"GET",credentials:"same-origin",headers:{"X-Auth":_cfg.auth,X_REQUESTED_WITH:"xmlhttprequest"}})}function popup_open_api2(o,n){return n&&n.addClass("loading"),new Promise(function(t,a){fetch_html_api(o).then(function(e){if(500<=e.status||404===e.status)return console.log("Couldn load popup failed with status: ",e.status),void a();e.text().then(function(e){if(e.error&&!appErrors.includes(e.error))return console.log("error: ",e.error),void a();popup_show(o,e,n,!0),t()})}).catch(function(e){a(e)})})}function popup_back(){$("#popup-content").remove(),$("#popup").append(popup_content),popup_content="",btn_unlock($(".popup-navigate")),btn_unlock($(".loading")),$(".tap").removeClass("tap")}function popup_close(){popup=!1,$("html").removeClass("popup-open").css("overflow",""),slideout&&slideout.enableTouch(),$("#overlay").removeClass("show"),hideStoreFloatingBtn(),$(".balance-real-maxdebt").removeClass("pulse"),setTimeout(function(){$("#overlay").hide(),$("#popup-content").empty(),$(".balance-live").hide()},110)}function callback_sw_store(e){void 0!==sws.store.extra&&$(".panel-mobile .sku-"+sws.store.extra.click).trigger("click")}function sw_twig(a,o,n){var e,t=o.replace(/\//g,"-");n.cfg=_cfg,"undefined"!=typeof data&&(n.data=data),$("#twig-"+t).length?(e=twig({data:$("#twig-"+t).text()}).render(n),a.find(".sw-content").html(e).removeClass("loading"),a.scrollTop(0),"function"==typeof window["callback_sw_"+o.replace(/-|\//g,"_")]&&window["callback_sw_"+o.replace(/-|\//g,"_")](n)):e=twig({href:_cfg.paths.views+"/ajax/"+o+".twig?"+_cfg.twig,async:!0,load:function(e){var t=e.render(n);a.find(".sw-content").html(t).removeClass("loading"),"gameweek"==o&&0<n.id_match?a.scrollTop($("#gameweek-match-"+n.id_match).offset().top-72):a.scrollTop(0),(a.find(".btn-credits").length||"store"==o)&&showStoreFloatingBtn(),"function"==typeof window["callback_sw_"+o.replace(/-|\//g,"_")]&&window["callback_sw_"+o.replace(/-|\//g,"_")](n),attachDragToScroll()}})}function sw_twig_clone(e,t,a,o,n){a.comments=n,a.html=$("#feed-"+a.id)[0].outerHTML,a.cfg=_cfg,"undefined"!=typeof data&&(a.data=data),template=twig({data:$("#twig-clone").text()}).render(a),e.find(".sw-title").text(_("Comentarios")),e.find(".sw-content").html(template).removeClass("loading").scrollTop(0),1==o&&e.find(".footer ul li").detach().appendTo(".card-comments ul"),e.find(".footer").remove()}$("body").on(on_tap_start,".btn",function(e){$(this).addClass("tap")}),$("body").on(on_tap_end,".btn",function(e){$(this).removeClass("tap")}),$("body").on("click",".btn-popup",function(){var e=$(this);e.hasClass("btn-show-bids")?sendEvent("select_show_bids"):e.hasClass("btn-clause")?sendEvent("show_clause"):"formation"==e.data("popup")&&sendEvent("select_formation"),e.hasClass("popup-navigate")&&(popup_content=$("#popup-content").clone(!0)),0<$(".sw-admin").length&&0===data.other.admin?e.hasClass("btn-admin-leave-league")?popup_open(e.data("popup"),e.data(),e,e.data("open"),e.data("preload")):toast(_("Solo los administradores pueden editar la configuración"),"red"):"api2"==e.data("type")?popup_open_api2(e.data("popup"),e):popup_open(e.data("popup"),e.data(),e,e.data("open"),e.data("preload")),"invite"==e.data("popup")&&sendEvent("invite")}),$("body").on("click",".btn-clauses-inactive",function(){toast(_("Tienes que tener activo el uso de cláusulas de rescisión para modificar esta configuración"),"red")}),$("body").on("click",".popup-back",function(){popup_back()}),$("#popup").on("submit","form",function(){return!1}),window.onpopstate=function(e){popup&&popup_close()},$("body").on("click","#popup, #btn-store-floating",function(e){e.stopPropagation()}),$("body").on("click",".btn-sw",function(){var e=$(this),t=e.data("sw"),a=e.data("url");window.location.hash=hash=void 0!==a?a:(1<Object.keys(e.data()).length&&void 0!==sws[t]&&(sws[t].extra=e.data()),t),e.data("title")&&$(".sw-title").text(e.data("title"))});var scroll_pos=0;function sw_open(t,e,a){0===scroll_pos&&(scroll_pos=document.documentElement.scrollTop||document.body.scrollTop);var o=$(".sw");o.find(".sw-content").addClass("loading"),0<e.length&&o.find(".sw-title").text(e),o.show(),$("html").addClass("sw-open"),void 0!==a?!a.clone||1<a.comments?$.ajax({url:"ajax/sw",data:"object"==typeof a?a:"post="+a,success:function(e){a.clone?sw_twig_clone(o,t,a,e.data.feed.comments.length,e.data.feed.comments):sw_twig(o,t,e.data)}}):a.clone&&a.comments<2&&sw_twig_clone(o,t,a,a.comments,{}):sw_twig(o,t,{})}function sw_close(){$("html").removeClass("sw-open"),document.documentElement.scrollTop=document.body.scrollTop=scroll_pos,scroll_pos=0,$(".sw-title").empty(),$(".sw-content").empty(),$(".sw").hide(),hideStoreFloatingBtn()}function aPage(e){if("undefined"!=typeof ga&&(ga("set","page",e),ga("send","pageview")),"undefined"!=typeof udm_&&udm_("//sb.scorecardresearch.com/b?c1=2&c2=6398301"),"undefined"!=typeof dataLayer){console.log("Sending GTM push");var t=dataLayer.push({event:"virtualPageView",virtualPageURL:e,virtualPageTitle:document.title+" "+e});console.log("GTM result: "+t)}"undefined"!=typeof agent&&agent.impression("default",customParams)}window.onhashchange=function(e){if(!window.location.hash.startsWith("#gameweek-match-")){var t,a,o=window.location.hash.replace("#","");if("sidebar"==o)return sw_close(),slideout.open(),void(hash=o);if(0===o.length||"_=_"==o)aPage(window.location.pathname),sw_close(),"sidebar"==hash&&slideout.close();else if(aPage(window.location.pathname+window.location.hash),o in sws)sw_open(o,t=sws[o].title,a=sws[o].post);else if(0===o.indexOf("players/")||0===o.indexOf("teams/")||0===o.indexOf("users/")||0===o.indexOf("matches/")||0===o.indexOf("comments/")||0===o.indexOf("contact")||0===o.indexOf("pool-")||0===o.indexOf("gameweek")){var n=o.split("/"),r=n[0],s=n[1],i=n[2],c=n[3];t="gameweek"==r?_("Jornada"):"",-1<window.location.href.indexOf("?gw=")&&(c=window.location.href.replace(/(.*)(gw=\d+)(.*)/,"$2")),a={post:r,id:s,slug:i,qs:c,clone:0,comments:0},"comments"==r&&$("#feed-"+s).length&&(a.clone=1,a.comments=$("#feed-"+s).data("comments")),sw_open(r,t,a)}else sw_open(o,"",a);hash=o}};var toast_open=!1,toast_timeout,undo=!1;function toast(e,t,a,o){clearTimeout(toast_timeout),a=a||5,(o=o||!1)&&(e=e+'. <button class="btn btn-undo">'+_("Deshacer cambio")+"</button>");var n=$("#toast");if(n.removeClass("toast-red toast-green flash"),n.html("<span>"+e+"</span>"),n.addClass("show"),"string"==typeof t&&n.addClass("toast-"+t),toast_open&&n.addClass("flash"),toast_open=!0,toast_timeout=setTimeout(function(){toast_close()},1e3*a),"undefined"!=typeof URLSearchParams){var r=new URLSearchParams(window.location.search);if(r.has("toast")&&(r.delete("toast"),history.pushState)){var s=window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+r.toString();window.history.pushState({path:s},"",s)}}}function toast_close(){undo=!1,$("#toast").removeClass("show flash"),toast_open=!1}$("#toast").on("click",function(){toast_close()}),$("#toast").on("click",".btn-undo",function(){if(undo){var e=$(this);btn_lock(e),undo.data.undo=!0,$.ajax({url:undo.url,data:undo.data,success:function(e){callback_sub_do(e,!1),toast(_("Acción deshecha")),undo=!1,e.assistant&&$(".assistant-recommendation-"+e.data.id).show()},complete:function(){btn_unlock(e)}})}});var lock=!1;function btn_lock(e){lock=!0,e.prop("disabled",!0),e.addClass("loading")}function btn_unlock(e){lock=!1,e.prop("disabled",!1),e.removeClass("loading")}var sws={},btn_purchase;function load_market(e){btn_lock($(".sw-market .filters")),$.ajax({url:"ajax/sw",data:e,success:function(a){if(a.data.players)twig({href:_cfg.paths.views+"/ajax/market.twig?"+_cfg.twig,load:function(e){var t=e.render(a.data);$(".sw-content").html(t)}})},complete:function(){$("#sw-market-filter select").prop("disabled",!1),btn_unlock($(".sw-market .filters"))}})}function getCurrency(e){var t=_cfg.currency.code,a={EUR:"€",USD:"$"}[t];return"EUR"==t?e.toString().replace(/[^\d-]/,_cfg.locale.decimal_point)+" "+a:a+e}function _(){var e=arguments;return e[0]=void 0!==_cfg.i18n[e[0]]&&""!=_cfg.i18n[e[0]]?_cfg.i18n[e[0]]:e[0],e.length<=1?e[0]:sprintf.apply(this,e)}function __(e,t,a){return sprintf(1==a?e:t,a)}function trans(e,t){return i18next.t(e,t)}sws.settings={title:_("Preferencias de usuario")},sws["settings/notifications"]={title:_("Notificaciones"),post:"notifications"},sws["settings/locale"]={title:_("Idioma y moneda")},sws.progression={title:_("Evolución de la clasificación"),post:"progression"},sws["live-changes"]={title:_("Cambios durante la jornada"),post:"live-changes"},sws.import={title:_("Liga y miembros")},sws.store={title:_("Tienda"),post:"store"},sws.subs={title:_("Cambios durante la jornada"),post:{post:"subs"}},sws.balance={title:_("Balance"),post:"balance"},data.market={post:"market",interval:"day"},sws.market={title:_("Evolución del mercado"),post:data.market},data.players={post:"players",filters:{position:0,value:0,team:0,injured:0,favs:0,owner:0,benched:0},offset:0,order:0,name:"",filtered:0},sws.players={title:_("Jugadores"),post:data.players},void 0!==_cfg.user&&(sws.competition={title:_cfg.user.competition,post:"competition"}),$("body").on("change","#sw-market-filter",function(){var e=$(this);e.find("select").prop("disabled",!0),data.market.interval=e.find("select[name=interval]").val(),load_market(data.market)}),$("#popup").on("input","input.check",function(){var e=$(this).val().toLowerCase(),t=$(this).data("word").toLowerCase();$("#btn-send").prop("disabled",e!=t)}),$("#verify-email").click(function(){var e=$(this);btn_lock(e),$.ajax({url:"ajax/verify",data:e.data(),error:function(){toast(msg.error,"red")},success:function(e){"ok"==e.status&&toast(_("Email de verificación enviado"))},complete:function(){btn_unlock(e)}})}),Twig.extendFilter("slug",function(e){return getSlug(e)}),Twig.extendFilter("shortName",function(e){var t=e=e||"";if(1<(e=e.split(" ")).length){var a=e[0].charAt(0);e.shift(),t=a+". "+(e=e.join(" "))}return t}),Twig.extendFilter("splitName",function(e,t){var a="",o=e;if(-1<e.indexOf(" ")){var n=e.split(" ");o=n.pop(),a=n.join(" ")}return"firstName"==t?a:o}),Twig.extendFilter("string",function(e){return String(e)}),Twig.extendFunction("getGameHomeTeamId",function(e){return e.id_home}),Twig.extendFunction("getGameHomeGoals",function(e){return e.goals_home}),Twig.extendFunction("getGameAwayGoals",function(e){return e.goals_away}),Twig.extendFunction("getGameStatus",function(e){return e.status}),Twig.extendFunction("getGameTv",function(e){return e.tv}),Twig.extendFunction("getGameDate",function(e){return e.date.text}),Twig.extendFunction("getGameDateFormat",function(e){return e.date.format}),Twig.extendFunction("getGameDateTimestamp",function(e){return e.date.ts}),Twig.extendFunction("getGameAwayTeamId",function(e){return e.id_away}),Twig.extendFunction("getGamePulse",function(e){return e.pulse}),Twig.extendFunction("getGameTv",function(e){return e.tv}),Twig.extendFunction("getGameHomeTeamId",function(e){return e.id_home}),Twig.extendFunction("getAvatarColor",function(e){return e.avatar.color}),Twig.extendFunction("getAvatarLetters",function(e){return e.avatar.letters}),Twig.extendFunction("getAvatarImageUrl",function(e){return e.avatar.imageUrl}),Twig.extendFunction("currency",function(e){return getCurrency(e)}),Twig.extendFunction("hasEmoji",function(e){try{return new RegExp(/\p{Extended_Pictographic}/,"u").test(e)}catch(e){}return!1}),Twig.extendFunction("_",_),Twig.extendFunction("__",function(e,t,a){return __(e,t,a)}),Twig.extendFunction("trans",function(e,t){return trans(e,t)}),Twig.extendFunction("static_image",function(e){return _cfg.static_image_base_url+e});var currentPromo=null;function setCurrentPurchasePromo(e){currentPromo=e}function getCurrentPurchasePromo(){return currentPromo}function setPromoForOrder(e,t){localStorage.setItem(e,t)}function getPromoForOrder(e){var t=parseInt(localStorage.getItem(e),10);return isNaN(t)?null:t}function removePromoForOrder(e){localStorage.removeItem(e)}function iOS_restoreTransaction(e,t){if(e)if(e.constructor===Array)if(e.length<=0)console.log("restoreTransaction purchases is empty");else if(t){var a=e[0];console.log(a),processRetryPurchase({sku:a.product,order_id:a.transaction,token:t,platform:_cfg.app})}else console.log("restoreTransaction receipt arg is falsy");else console.log("restoreTransaction purchases arg is not array");else console.log("restoreTransaction purchases arg is falsy")}function listPendingPurchases(){return"undefined"!=typeof MRInterface&&void 0!==MRInterface.listPendingPurchases?(MRInterface.listPendingPurchases(),!0):"ios"==_cfg.app&&void 0!==window.webkit.messageHandlers.listPendingPurchases&&(console.log("New list pending purchases"),window.webkit.messageHandlers.listPendingPurchases.postMessage(""),!0)}function listPendingPurchasesCallback(e){if(e){var t=JSON.parse(e);if(!t.length||t.length<=0)console.log("No pending purchases found (two step)");else{console.log(t);var a=JSON.parse(t[0]);processRetryPurchase({sku:a.productId,order_id:a.orderId,token:a.purchaseToken,platform:_cfg.app})}}else console.log("listPendingPurchasesCallback with falsy argument")}function getPurchaseByToken(e){return new Promise(function(t,a){fetch("/api2/store/purchases?token="+e,{method:"GET",credentials:"same-origin",headers:{"X-Auth":_cfg.auth,X_REQUESTED_WITH:"xmlhttprequest","Content-Type":"application/json"}}).then(function(e){if(200!==e.status)return a(e.status);e.json().then(function(e){t(e)})}).catch(function(e){a(e)})})}function consumePurchase(e){"ios"==_cfg.app?(console.log("consuming order_id",e.order_id),window.webkit.messageHandlers.consumePurchase.postMessage(e.order_id)):"android"==_cfg.app&&MRInterface.consume(e.token),sendPurchaseEvent(e.token)}function sendPendingPurchaseEvents(){var e=getPaypalPurchases();0!==e.length?sendPurchaseEvent(e.pop()).then(function(){savePaypalPurchases(e),sendPendingPurchaseEvents()}).catch(function(e){console.log("SendPurchaseEvent failed: ",e),setTimeout(sendPendingPurchaseEvents,3e4)}):console.log("No pending purchases")}function sendPurchaseEvent(e){return new Promise(function(n,r){getPurchaseByToken(e).then(function(e){var t=new Date,a=new Date(e.date);if(console.log(t,a),1<(t.getTime()-a.getTime())/1e3/60/60)return console.log("Purchase is too old"),void n();if("completed"==e.status){var o={af_revenue:e.gross,af_currency:"EUR",af_quantity:1,af_content:e.sku};sendEvent("af_purchase",o),n()}else r("not completed")}).catch(function(e){404!==e?(console.log("Couldn't get purchase by token so we can't send purchase event",e),r(e)):n()})})}function processRetryPurchase(t){var e=getPromoForOrder(t.order_id);e&&(t.id_promo=e),console.log("Process retry purchase: ",t),processPurchase(t).then(function(e){e&&(updateCredits(e),location.reload()),removePromoForOrder(t.order_id)}).catch(function(){console.log("processPurchase failed"),setTimeout(listPendingPurchases,5e3)})}function processDirectPurchase(t){var e=getCurrentPurchasePromo();e&&(t.id_promo=e,setPromoForOrder(t.order_id,e)),console.log("Processing a direct purchase",t),processPurchase(t).then(function(e){toast(_("Compra realizada, ¡gracias!")),btn_unlock(btn_purchase),e?(updateCredits(e),location.reload()):console.log("Performed purchase but no credits were returned"),removePromoForOrder(t.order_id)}).catch(function(){toast(_("La compra se intentará de nuevo más tarde"),"red"),btn_unlock(btn_purchase),setTimeout(listPendingPurchases,1e3)})}function processPurchase(n){console.log("Processing purchase:",n);var r=["Existing Token","discarted token","Existing Order"];return new Promise(function(a,o){sendPurchase(n).then(function(e){if(500<=e.status||404===e.status)return console.log("SendPurchase failed with status: ",e.status),void o();e.json().then(function(e){if(e.error&&!r.includes(e.error))return console.log("error: ",e.error),void o();consumePurchase(n);var t=null;e.credits&&(t=e.credits),a(t)})}).catch(function(e){o(e)})})}function purchaseSuccessful(e,t,a){console.log("Two step purchase success: ",e,t,a),processDirectPurchase({sku:t,order_id:a,token:e,platform:_cfg.app})}function startAndroidPurchase(e,t,a){return void 0!==MRInterface.launchTwoStepAppPurchase?(MRInterface.launchTwoStepAppPurchase(e,t,a),console.log("Initializing android two step purchase",e,t,a),!0):(console.log("Two step purchase api is missing"),!1)}function startIOSPurchase(e){return void 0!==window.webkit.messageHandlers.launchTwoStepAppPurchase?(console.log("Starting new ios purchase"),window.webkit.messageHandlers.launchTwoStepAppPurchase.postMessage("com.playmister.ios."+e),!0):(console.log("Two step purchase api is missing"),!1)}function sendPurchase(e){return newStoreIap?e.member_id=_cfg.user.id_uc:e.id_community=_cfg.user.id_community,fetch("/api2/store/receiveboughtitems",{method:"POST",credentials:"same-origin",headers:{"X-Auth":_cfg.auth,X_REQUESTED_WITH:"xmlhttprequest","Content-Type":"application/json"},body:JSON.stringify(e)})}setTimeout(function(){sendPendingPurchaseEvents()},2e3);var paypalStoreKey="paypal_purchases";function savePaypalPurchase(e){var t=getPaypalPurchases();t.push(e),savePaypalPurchases(t)}function savePaypalPurchases(e){localStorage.setItem(paypalStoreKey,JSON.stringify(e))}function getPaypalPurchases(){var e=localStorage.getItem(paypalStoreKey);return e="string"!=typeof e||0===e.length?[]:JSON.parse(e)}function startPayment(e,t,a,o){var n={Gateway:"paypal",id_community:a,SKU:e},r="api/v1/payments";return newStorePaypal&&(r="api2/store/buyWithPaypal",n.memberId=o),t&&(n.id_promo=t),new Promise(function(t,a){fetch(r,{method:"POST",credentials:"same-origin",headers:{"X-Auth":_cfg.auth,X_REQUESTED_WITH:"xmlhttprequest","Content-Type":"application/json"},body:JSON.stringify(n)}).then(function(e){if(500<=e.status||404===e.status)return console.log("startPayment failed with status: ",e.status),void a();e.json().then(function(e){t(e),savePaypalPurchase(e.token)}).catch(function(e){console.log("Failed to parse response from startPayment",e),a(e)})}).catch(function(e){console.log("Error in startPayment request",e)})})}function iOS_launchAppPurchase(e,t,a,o){"ok"==t?void 0!==window.webkit.messageHandlers.launchTwoStepAppPurchase?("string"==typeof a&&0!=a.length||(a="ios-blank-id"),processDirectPurchase({sku:e,order_id:a,token:o,platform:_cfg.app})):console.log("Two step purchase missing"):btn_unlock(btn_purchase)}function iOS_purchaseSuccessful(){iOS_launchAppPurchase.apply(null,arguments)}$("body").on("click","#purchase-button",function(){btn_lock(btn_purchase=$(this));var e=_cfg.user.id_community,t=btn_purchase.data("id"),a=btn_purchase.data("sku"),o=Math.floor((new Date).getTime()/1e3),n=parseInt(btn_purchase.data("promo"),10);isNaN(n)&&(n=null),setCurrentPurchasePromo(n),"android"!=_cfg.app?"ios"!=_cfg.app?startPayment(a,n,e,t).then(function(e){e.URL&&""!=e.URL?location.href=e.URL:(toast(_("Algo ha fallado"),"red"),btn_unlock(btn_purchase))}).catch(function(){toast(_("No se pudo iniciar la compra"),"red"),btn_unlock(btn_purchase)}):startIOSPurchase(a):startAndroidPurchase(a,t,o)}),$("body").on("click","#paypal-button-container",function(){btn_lock(btn_purchase=$(this));var e=_cfg.user.id_community,t=_cfg.user.id_uc,a=btn_purchase.data("sku"),o=parseInt(btn_purchase.data("promo"),10);isNaN(o)&&(o=null),startPayment(a,o,e,t).then(function(e){btn_unlock(btn_purchase),e.URL&&""!=e.URL?("ios"==_cfg.app?($("#paypal-button-container").hide(),$("#paypal-link-container").css("display","block").attr("href",e.URL)):location.href=e.URL,updateCreditsUntilChange()):toast(_("Algo ha fallado"),"red")}).catch(function(){toast(_("No se pudo iniciar la compra"),"red"),btn_unlock(btn_purchase)})}),"android"!=_cfg.app&&"ios"!=_cfg.app||retryPurchases();var purchaseAttemps=0;function retryPurchases(){listPendingPurchases()||console.log("Missing two step purchase api")}function fetchCredits(t){$endpoint="api2/users/currentcredits",newStoreCredits||($endpoint="api/v1/user/currentcredits"),$.ajax({url:$endpoint,type:"GET",headers:{"Content-Type":"application/json","X-User-ID":_cfg.user.id},success:function(e){console.log("Got:",e.credits),t(e.credits)},error:function(){console.log("Error fetching credits")},complete:function(){}})}function updateCredits(e){var t=thousands(_cfg.user.credits=e);$(".credits-count").text(t)}var initialCredits=null,reg,sub;function updateCreditsUntilChange(){null==initialCredits&&(initialCredits=_cfg.user.credits),console.log("UpdateCredits until change",initialCredits),fetchCredits(function(e){initialCredits!=e?(console.log("New credits arrived",initialCredits,e),initialCredits=thousands(e),updateCredits(e),location.reload()):(console.log("Scheduling again"),setTimeout(updateCreditsUntilChange,2e3))})}function ntf_subscribe(e){$.ajax({url:"api/notifications/subscribe",data:{endpoint:e},success:function(e){e.status}})}function ntf_unsubscribe(){reg.pushManager.subscribe({userVisibleOnly:!0}).then(function(e){(sub=e).unsubscribe().then(function(e){}).catch(function(e){console.log("Error unsubscribing",e)})})}$("body.closed").on("click",".btn-sw-link",function(e){e.preventDefault();var t=$(this);t.hasClass("player")?sendEvent("clicked_player"):t.hasClass("team")?sendEvent("clicked_team"):t.hasClass("user")&&sendEvent("select_gameuser"),window.location.hash=hash=t.attr("href"),e.target.classList.contains("btn-match")||$(".sw-title").text(t.data("title"))}),$("body").on("click",".btn-dd",function(e){var t=$(this),a=t.data("dd");$("."+a).toggle();var o=$("."+a).is(":visible")?"close":"open";t.removeClass("open close").addClass(o)}),$(".alert-app .btn-close").click(function(){Cookies.set("alert_app",1,{expires:7,path:"/"}),$(".alert-app").remove()}),"https:"==document.location.protocol&&"serviceWorker"in navigator&&!_cfg.open&&"onboarding"!=_cfg.pag&&0<_cfg.user.id&&-1<_cfg.app.indexOf("web")&&navigator.serviceWorker.register("sw.js").then(function(){return navigator.serviceWorker.ready}).then(function(e){reg=e,"web"==_cfg.app&&reg.pushManager.getSubscription().then(function(e){void 0===_cfg.user||e&&0!==_cfg.user.tokens.length||reg.pushManager.subscribe({userVisibleOnly:!0}).then(function(e){ntf_subscribe((sub=e).endpoint)}).catch(function(e){console.log("pushManager.subscribe error",e)})}).catch(function(e){console.log("pushManager.getSubscription error",e)})}).catch(function(e){console.log("serviceWorker.register error",e)}),$(".noob-alert .btn-close").click(function(){var e=Cookies.get("alerts")?Cookies.get("alerts").split("|"):[];e.push($(this).data("alert")),Cookies.set("alerts",e.join("|"),{expires:30,path:"/"}),$(".noob-alert").remove()}),$("body").on("click",".btn-share",function(){var e=$(this).data();"android"==_cfg.app?MRInterface.openShareDialog(e.title,e.text,e.url):"ios"==_cfg.app?window.webkit.messageHandlers.openShareDialog.postMessage(JSON.stringify(e)):navigator.share({title:e.title,text:e.text,url:e.url})});var attachedScrolls={};function attach_scroll(o,n){void 0===attachedScrolls[n]&&(attachedScrolls[n]={hide_footer:!1,last_scroll:0},o.scroll(function(){var e=$(this).scrollTop(),t=o.get(0).scrollHeight||document.documentElement.scrollHeight,a=e+o.height()+1>=t;e>attachedScrolls[n].last_scroll&&!a?attachedScrolls[n].hide_footer||($(n).addClass("footer-hide"),attachedScrolls[n].hide_footer=!0):attachedScrolls[n].hide_footer&&($(n).removeClass("footer-hide"),attachedScrolls[n].hide_footer=!1),attachedScrolls[n].last_scroll=e}))}function update_balance(){var t;$.ajax({url:"ajax/balance",success:function(e){_cfg.user.balance=e.data,t=999999<Math.abs(e.data.balance)?Number(e.data.balance/1e6).toFixed(1).replace(".",_cfg.locale.decimal_point)+" M":thousands(e.data.balance),$(".balance-real-current").text(thousands(e.data.balance)),$(".header-top .balance-real-current").text(t),$(".balance-real-future").text(thousands(e.data.future)),$(".balance-real-maxdebt").text(thousands(e.data.max_debt)),0<=e.data.future?$(".balance-real-future").removeClass("pulse red"):$(".balance-real-future").addClass("pulse"),0<e.data.max_debt?$(".balance-real-maxdebt").removeClass("pulse"):$(".balance-real-maxdebt").addClass("pulse")}})}function update_future(e){var t=$(".balance-live-future"),a=_cfg.user.balance.future-e;t.text(thousands(a)),0<=a?t.removeClass("pulse red"):0<=_cfg.user.balance.future&&a<0&&t.addClass("pulse")}function open_bid(e){if(void 0===_cfg.user.balance.balance&&$.ajax({url:"ajax/balance",async:!1,success:function(e){_cfg.user.balance=e.data}}),$(".balance-live-current").text(thousands(_cfg.user.balance.balance)),_cfg.user.balance.balance<0&&$(".balance-live-current").addClass("red"),$(".balance-live-future").text(thousands(_cfg.user.balance.future)),_cfg.user.balance.future<0&&$(".balance-live-future").addClass("red"),$(".balance-live-maxdebt").text(thousands(_cfg.user.balance.max_debt)),$("#input-range").attr("max",_cfg.user.balance.max_debt),0===_cfg.user.balance.max_value&&$(".balance-live-maxdebt").hide(),"object"==typeof e){if(e.price>_cfg.user.balance.max_debt&&!e.active)$("#btn-send").attr("disabled","disabled"),$(".balance-live-maxdebt").addClass("pulse");else if(e.active){var t=Math.floor(_cfg.user.balance.max_debt+parseInt(e.input));$(".balance-live-maxdebt").text(thousands(t)),$("#input-range").attr("max",t),$("#input-range").attr("value",e.input)}update_future(e.active?0:parseInt($(".input-amount").val().replace(/[^\d-]/g,"")))}$(".balance-live").css("display","flex")}function open_sign(e){open_bid(e)}function open_loan_request(e){open_bid(e)}function open_clause_pay(e){open_bid(e)}function open_clause_set(){open_bid()}function callback_sale(e,t){var a,o;-1<t.indexOf("#players")&&(o=$(".sw .btn-sell"),"sale"==e.action||"update"==e.action?(o.data("active",!0),o.data("input",parseInt(e.price)),o.data("price",parseInt(e.price)),o.removeClass("btn-dark").addClass("btn-green").text(_("En venta"))):"remove"!=e.action&&"force-remove"!=e.action||(o.data("active",!1),o.data("input",parseInt(e.price)),o.data("id_market",null),o.removeClass("btn-green").addClass("btn-dark").text(_("Vender")))),-1<t.indexOf("/team")&&(o=(a=$(".player-"+e.owner+"-"+e.id_player)).find(".btn-sale"),"sale"==e.action||"update"==e.action?(o.data("active",!0),o.data("input",parseInt(e.price)),o.data("price",parseInt(e.price)),o.removeClass("btn-grey").addClass("btn-green").text(_("En venta")),a.find(".header .right").text(thousands(e.price))):"remove"!=e.action&&"force-remove"!=e.action||(o.data("active",!1),o.data("input",parseInt(e.price)),o.removeClass("btn-green").addClass("btn-grey").text(_("Vender")),a.find(".header .right").empty())),-1<t.indexOf("/market")&&(o=(a=$(".player-"+e.owner+"-"+e.id_player)).find(".btn-bid"),"update"==e.action?(o.data("input",parseInt(e.price)),o.data("price",parseInt(e.price)),a.find(".header .right").text(thousands(e.price))):"remove"!=e.action&&"force-remove"!=e.action||(a.remove(),$(".sale-"+e.id_market).remove(),0===$("#offers ul li").length&&$("#offers").remove())),updateReceivedOffersCount(e.offers)}function callback_resale(e,t){$("#list-on-sale .player-"+e.owner+"-"+e.id_player).data("ends",e.ends),$(".sw-market-offers .player-"+e.owner+"-"+e.id_player).remove(),0===$(".sw-market-offers ul li").length&&history.back(),updateReceivedOffersCount(e.offers),toast(_("Acción realizada"),"green")}function callback_direct_sell(e,t){if(-1<t.indexOf("#players")&&$(".bottom-actions, .bottom-placeholder").remove(),-1<t.indexOf("/team")){toast(_("Jugador vendido")),$(".player-"+e.owner+"-"+e.id_player).remove();var a=$(".lineup-player-"+e.id_player),o=a.find(".pic");a.removeClass("st-injury st-doubt st-red st-double st-five st-other"),a.find(".st").remove(),empty_slot(a,o,e.id_player)}update_balance(),updateReceivedOffersCount(e.offers)}function callback_loanable(e,t){var a,o;a=$(".player-"+e.owner+"-"+e.id_player),-1<t.indexOf("#players")&&(o=$(".sw .btn-sell"),"add"==e.action?o.data("loanable",1):"remove"==e.action&&o.data("loanable",null)),-1<t.indexOf("/team")&&(o=a.find(".btn-sale"),"add"==e.action?(o.removeClass("btn-grey").addClass("btn-green").text(_("Cedible")),o.data("popup","loanable"),o.data("loanable",1)):(o.removeClass("btn-green").addClass("btn-grey").text(_("Vender")),o.data("popup","sale"),o.data("loanable",null))),-1<t.indexOf("/market")&&(o=a.find(".btn-bid"),"remove"==e.action&&a.remove())}function callback_bid(e,t){var a,o;-1<t.indexOf("#players")&&(o=$(".sw .btn-bid"),"bid"==e.action||"update"==e.action?(o.data("active",!0),o.data("input",parseInt(e.bid)),o.data("price",parseInt(e.bid)),o.data("id_market",e.id_market),o.data("barter",e.barter),o.removeClass("btn-dark").addClass("btn-green").html(updateBidText(e))):"remove"==e.action&&(o.data("active",!1),o.data("input",parseInt(e.price)),o.text(_("Pujar")),o.removeClass("btn-green").addClass("btn-dark").text(_("Pujar"))),o.data("popup","bid"),o.data("type","normal")),-1<t.indexOf("#users")&&(o=(a=$(".player-"+e.owner+"-"+e.id_player)).find(".btn-bid"),"bid"==e.action||"update"==e.action?(o.data("active",!0),o.data("input",parseInt(e.bid)),o.data("price",parseInt(e.bid)),o.data("id_market",e.id_market),o.data("barter",e.barter),o.addClass("btn-green").html(updateBidText(e))):"remove"==e.action&&(o.data("active",!1),o.data("input",parseInt(e.price)),o.removeClass("btn-green").text(_("Ofertar"))),o.data("popup","bid"),o.data("type","normal")),(-1<t.indexOf("/market")||-1<t.indexOf("/feed"))&&(o=(a=$(".player-"+e.owner+"-"+e.id_player)).find(".btn-bid"),"bid"==e.action||"update"==e.action?(o.data("active",!0),o.data("input",parseInt(e.bid)),o.data("barter",e.barter),o.addClass("btn-green").html(updateBidText(e))):"remove"==e.action&&(o.data("active",!1),o.data("input",parseInt(e.price)),o.text(thousands(e.price)),o.removeClass("btn-green")),a.find(".header .right").empty(),o.data("popup","bid"),o.data("type","normal")),o.data("open",o.data()),update_balance()}function updateBidText(e){return 0<Object.keys(e.barter).length?(e.bid/1e6).toFixed(1).replace(".",_cfg.locale.decimal_point)+' M <div class="pic" data-players="'+Object.keys(e.barter).length+'"><img src="'+_cfg.pics+"img/players/"+Object.keys(e.barter)[0]+'.png" loading="lazy"></div>':thousands(e.bid)}function callback_loan_request(e,t){var a,o;-1<t.indexOf("#players")&&(o=$(".sw .btn-bid"),"loan"==e.action||"update"==e.action?(o.data("popup","loan-request"),o.data("active",!0),o.data("input",parseInt(e.bid)),o.data("price",parseInt(e.bid)),o.data("id_market",e.id_market),o.data("weeks",e.weeks),o.addClass("btn-green").text(thousands(e.bid))):"remove"==e.action&&(o.data("popup","bid"),o.data("active",!1),o.data("input",parseInt(e.price)),o.text(_("Ofertar")),o.removeClass("btn-green")),o.data("open",o.data()),o.data("type","loan")),-1<t.indexOf("#users")&&(o=(a=$(".player-"+e.owner+"-"+e.id_player)).find(".btn-bid"),"loan"==e.action||"update"==e.action?(o.data("popup","loan-request"),o.data("active",!0),o.data("input",parseInt(e.bid)),o.data("price",parseInt(e.bid)),o.data("id_market",e.id_market),o.data("weeks",e.weeks),o.addClass("btn-green").text(thousands(e.bid))):"remove"==e.action&&(o.data("popup","bid"),o.data("active",!1),o.data("input",parseInt(e.price)),o.text(_("Ofertar")),o.removeClass("btn-green")),o.data("open",o.data()),o.data("type","loan")),-1<t.indexOf("/market")&&(o=(a=$(".player-"+e.owner+"-"+e.id_player)).find(".btn-bid"),"loan"==e.action||"update"==e.action?(o.data("popup","loan-request"),o.data("active",!0),o.data("input",parseInt(e.bid)),o.data("weeks",e.weeks),o.addClass("btn-green").text(thousands(e.bid)),a.find(".header .right").text(trans("WEEKS_N",{weeksCount:e.weeks}))):"remove"==e.action&&(o.data("popup","bid"),o.data("active",!1),o.data("input",parseInt(e.price)),o.text(thousands(e.price)),o.removeClass("btn-green"),a.find(".header .right").empty()),o.data("open",o.data()),o.data("type","loan")),update_balance()}function callback_sign(e,t){toast(_("Fichaje realizado")),$(".player-"+e.owner+"-"+e.id_player+" .btn-bid").removeClass("btn-popup btn-grey").addClass("btn-white"),update_balance()}function callback_settings(e){if(toast(_("Configuración guardada"),"green"),e.key.indexOf("notifications_")<0)return"feed";if("notifications_gameweek_match_points"==e.key){var t={0:_("Ninguno"),1:_("Todos"),2:_("En que jugadores míos han disputado"),3:_("En que jugadores de algún miembro de la liga han disputado")},a=$("#notifications_gameweek_match_points");a.data("value",e.value),a.find("p").text(t[e.value])}}function callback_clause_pay(e){return"feed"}function callback_loan_confirm(e){return"feed"}function callback_contest_join(e){return"feed"}function formatIntlDate(e,t){var a=[_("Domingo"),_("Lunes"),_("Martes"),_("Miércoles"),_("Jueves"),_("Viernes"),_("Sábado")],o=[_("enero"),_("febrero"),_("marzo"),_("abril"),_("mayo"),_("junio"),_("julio"),_("agosto"),_("septiembre"),_("octubre"),_("noviembre"),_("diciembre")],n=new Date(1e3*t),r=n.getHours()+":"+(n.getMinutes()<10?"0"+n.getMinutes():n.getMinutes());return e.replace("H:mm",r).replace("EEE",a[n.getDay()].substr(0,3)).replace(/^d/,n.getDate()).replace("MMM",o[n.getMonth()].substr(0,3)).replace(/'/g,"")}function local_time(){$(".tz").each(function(){var e=$(this),t=e.data("format"),a=e.data("ts");e.text(formatIntlDate(t,a)),e.removeClass("tz")})}function load_notifications(){notifications_loaded||($("#ajax-notifications").addClass("loading"),$.ajax({url:"ajax/notifications",success:function(e){template=twig({data:$("#twig-notifications").text()}).render(e),$("#ajax-notifications").append(template),notifications_loaded=!0},complete:function(){$("#ajax-notifications").removeClass("loading")}}))}$("body").on("click",".settings-options label",function(){var e=$(this).parent().find("input"),t="radio"==e.attr("type")||!e.prop("checked");e.prop("checked",t)}),$("body").on("click",".btn-toggle input",function(){var e=$(this),t=e.closest(".btn-toggle"),a=t.data("key"),o=+e.prop("checked"),n=t.data("url"),r=!1;if(n){var s,i={key:a,value:o};$.ajax({url:"ajax/"+n,data:i,success:function(e){"ok"==e.status&&("function"==typeof window["callback_"+n.replace(/-|\//g,"_")]?r=window["callback_"+n.replace(/-|\//g,"_")](e.data):(s=1==parseInt(e.data.value)?t.find(".subtitle").text()==_("Desactivado")?_("Activado"):_("Sí"):t.find(".subtitle").text()==_("Activado")?_("Desactivado"):_("No"),t.find(".subtitle").text(s)))},complete:function(){r&&("string"!=typeof r||-1<r.indexOf("#")?location.reload():window.location.href=_cfg.base+r)}})}}),$("#popup").on("input","#clause_range",function(){var e=$(this),t=parseInt(e.val()),a=parseFloat(e.data("floor")),o=parseInt(a*[1.5,2,2.5,3,3.5,4][t]),n=parseInt(e.data("default")),r=Math.floor(.2*a*(t-n));sendEvent("select_clause"),$(".top .range-value").text(6==t?_("Blindado"):thousands(o)),n<t?($(".bottom .swipe").hide(),$(".bottom .pay").show(),6==t?($(".btn-pay, .btn-purchase, .btn-credits").hide(),$(".btn-purchase-shield").show(),$(".bottom .separator p").text(_("Blindar jugador durante…")),update_future(0)):($(".btn-purchase-shield").hide(),$(".btn-pay").show().html('<svg class="coin-real"><use href="'+_cfg.svg+'#balance"></use></svg> '+thousands(r)),$(".bottom .separator p").text(_("Subir cláusula pagando…")),$(".btn-purchase-clause").show().data("sku","clause_"+(t-n)),$(".btn-purchase-clause").html('<svg class="coin-virtual"><use href="'+_cfg.svg+'#coin"></use></svg> '+_cfg.sku_prices["clause_"+(t-n)]),update_future(r))):t==n?($(".bottom .pay").hide(),$(".bottom .swipe").show(),update_future(r)):($(".bottom .swipe").hide(),$(".bottom .pay").show(),$(".btn-pay").show().html('<svg class="coin-real"><use href="'+_cfg.svg+'#balance"></use></svg> '+thousands(Math.abs(Math.floor(r/2)))),$(".bottom .separator p").text(_("Bajar cláusula e ingresar…")),$(".btn-purchase, .btn-credits").hide(),update_future(-1*Math.abs(Math.floor(r/2))))}),$("#popup").on("input","#pool_range",function(){var e=$(this),t=parseInt(e.val()),a=e.data("prices"),o=e.data("prizes");a.forEach(function(e){e.step==t&&(selectedPrice=e.price)}),o.forEach(function(e){$("#hits-"+e.hits).find(".prize").html('<svg class="coin-virtual"><use href="'+_cfg.svg+'#coin"></use></svg> '+selectedPrice*e.multiplier)}),$("#play-pool").html(_("Participar")+' <svg class="coin-virtual"><use href="'+_cfg.svg+'#coin"></use></svg> '+selectedPrice)}),$("#popup").on("click",".form-range .btn-pay",function(){var e=$(this);btn_lock(e),$.ajax({url:"ajax/clause-set",data:$("#popup form").serialize(),success:function(e){if("ok"==e.status){sendEvent("change_clause");var t=$(".bottom-actions .btn-clause"),a=parseInt(t.data("floor")*e.data.multiplier);t.data("multiplier",e.data.multiplier),t.data("default",e.data.clause),$(".item-clause .value").text(thousands(a)),history.back(),toast(_("Cláusula modificada")),update_balance()}},complete:function(){btn_unlock(e)}})}),$("#popup").on("click","#btn-send",function(){var e=$(this);btn_lock(e);var t=!1,a=e.data("ajax"),o=["bid","clause-pay","sale","loanable"];"bid"==a?sendEvent("place_bid"):"clause-pay"==a&&sendEvent("pay_clause"),$.ajax({url:"ajax/"+a,data:$("#popup form").serialize(),success:function(e){-1!==o.indexOf(a)&&showInterstitial(a),"ok"==e.status?("function"==typeof window["callback_"+a.replace(/-|\//g,"_")]&&(t=window["callback_"+a.replace(/-|\//g,"_")](e.data,window.location.href)),t||history.back()):"navigate"==e.status&&(popup_content=$("#popup-content").clone(!0),popup_open(e.popup,e.data))},complete:function(){t?"string"!=typeof t||-1<t.indexOf("#")?location.reload():window.location.href=_cfg.base+t:btn_unlock(e)}})}),$("#popup").on("change","#upload",function(){var e=this.files[0];8388608<e.size||-1==e.type.indexOf("image/")?(toast(_("El archivo es muy grande o no es una imagen"),"red"),$("#btn-send-pic").prop("disabled",!0)):($("#btn-send-pic").prop("disabled",!1),$("#btn-send-pic").show(),$("#preview").show(),$(".choose").hide(),$(".footer .buttons").addClass("btn-2"))}),$("#popup").on("click",".btn-rotate",function(){$("#preview").cropit("rotateCW")}),$("#popup").on("click","#btn-send-pic",function(){var e={pic:$("#preview").cropit("export",{type:"image/png"})};btn_lock($(this)),$.ajax({url:"ajax/picture",data:e,success:function(e){window.location.href=_cfg.base+"more"}})}),$("body").on("click",".btn-pic-fb, .btn-pic-delete",function(){var e=$(this);btn_lock(e);var t={pic:e.data("pic")};$.ajax({url:"ajax/picture",data:t,success:function(e){window.location.href=_cfg.base+"more"}})}),local_time(),$("body").on("click",".btn-translate",function(){var t=$(this);btn_lock(t);var e=t.data("pag"),a={pag:e};"post-excerpt"==e?a.text=t.parent().find("p.ajax-show").text():"post-full"==e?a.text=t.parent().find(".markdown").text():"poll"==e?a.text=t.parent().find("p").text():"notification"==e?a.text=t.parent().find(".title").text()+". "+t.parent().find(".body").text():"player"==e&&(a.text=t.parent().find("p").text()),$.ajax({url:"ajax/translate",data:a,success:function(e){t.after('<p class="translated">'+e.translation+"</p>"),t.remove()},complete:function(){btn_unlock(t)}})}),$("#popup").on("input","#range-loan",function(){$(".range-value").text(trans("WEEKS_N",{weeksCount:this.value})),update_popup_send()}),$("body").on("click",".btn-shield",function(){toast(_("Expira en %s",$(this).data("shield")))}),$("body").on("click",".btn-favorite",function(e){e.preventDefault();var t=$(this);btn_lock(t),$.ajax({url:"ajax/favorite",data:t.data(),success:function(e){"ok"==e.status&&("add"==e.action?(svgChangeIcon(t,"star-filled"),"player"==t.data("type")?toast(_("Jugador añadido a la lista de favoritos")):"team"==t.data("type")&&toast(_("Equipo añadido a la lista de favoritos")),t.data("action","remove")):"remove"==e.action&&(svgChangeIcon(t,"star"),"player"==t.data("type")?toast(_("Jugador eliminado de la lista de favoritos")):"team"==t.data("type")&&toast(_("Equipo eliminado de la lista de favoritos")),t.data("action","add")),"list"==t.data("from")&&t.closest("li").remove())},complete:function(){btn_unlock(t)}})});var qd_touchstart="ontouchstart"in document?"touchstart":"mousedown",qd_touchend="ontouchend"in document?"touchend touchcancel":"mouseup",qd_touchmove="ontouchmove"in document?"touchmove":"mousemove",qd_pressed=!1,qd_opened=!1,qd_element,btn_pools;function qd_open(){qd_opened=!0,$("#quick-dialog").show(),$("html").css("overflow","hidden"),slideout&&slideout.disableTouch(),$("#overlay").css("display","flex").width(),$("#overlay").addClass("show"),$("#popup").hide()}function qd_close(){qd_opened=!1,$("html").css("overflow",""),slideout&&slideout.enableTouch(),$("#overlay").removeClass("show"),setTimeout(function(){$("#overlay").hide(),$("#popup").show(),$("#quick-dialog").hide().empty()},110)}function facebookLogoutCallback(e){toast(_(e?"Éxito":"Error"))}function input_error(e,t){e.classList.contains("error")?$(e).parent().find("div.error").text(t):($(e).addClass("error").parent().append('<div class="error">'+t+"</div>").width(),$(e).parent().find("div.error").css("opacity",1),$("#btn-send").attr("disabled",!0))}function input_ok(e){e.classList.contains("error")&&($(e).removeClass("error").parent().find("div.error").css("opacity",0),setTimeout(function(){$(e).parent().find("div.error").remove()},110),$("#btn-send").attr("disabled",!1))}function check_name(e){var t=0<e.value.length;return t?(input_ok(e),$(e).removeClass("check-on-input")):(input_error(e,_("El nombre no puede estar vacío")),$(e).addClass("check-on-input")),t}function check_email(e){var t=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(String(e.value).toLowerCase());return t?(input_ok(e),$(e).removeClass("check-on-input")):(input_error(e,_("El email no es correcto")),$(e).addClass("check-on-input")),t}function check_password(e){var t=6<=e.value.length;return t?(input_ok(e),$(e).removeClass("check-on-input")):(input_error(e,_("La contraseña debe tener al menos %s caracteres",6)),$(e).addClass("check-on-input")),t}function check_code(e){var t=0<e.value.length;return t?(input_ok(e),$(e).removeClass("check-on-input")):(input_error(e,_("El código no puede estar vacío")),$(e).addClass("check-on-input")),t}function check_debt(e,t){var a=!1;return _cfg.user.balance.max_value&&(!t.active&&e>_cfg.user.balance.max_debt||t.active&&e>_cfg.user.balance.max_debt+parseInt(t.input))?(a=!0,$(".balance-real-maxdebt").addClass("pulse")):$(".balance-real-maxdebt").removeClass("pulse"),a}function check_bid(e){var t=parseInt(e.value.replace(/[^\d-]/g,"")),a=$(e).data();check_debt(t,a)?input_error(e,_("No puedes superar tu deuda máxima")):0===a.owner&&t<a.price?input_error(e,_("No puedes pujar por debajo del valor de mercado")):t<0||isNaN(t)?input_error(e,_("La puja debe ser mayor que 0")):1e9<t?input_error(e,_("No puedes pujar por encima de los 1.000M")):input_ok(e),update_future(a.active?t-a.input:t)}function check_sale(e){var t=parseInt(e.value.replace(/[^\d-]/g,""));t<1||isNaN(t)?input_error(e,_("El precio debe ser mayor que 0")):input_ok(e)}function check_loan(e){var t=parseInt(e.value.replace(/[^\d-]/g,"")),a=$(e).data();check_debt(t,a)?input_error(e,_("No puedes superar tu deuda máxima")):t<1||isNaN(t)?input_error(e,_("La oferta debe ser mayor que 0")):0<_cfg.user.loans_floor&&t<a.value*_cfg.user.loans_floor/100*$("#range-loan").val()?input_error(e,_("El coste por semana debe ser mayor o igual que el %s%% del valor del jugador",_cfg.user.loans_floor)):1e9<t?input_error(e,_("No puedes pujar por encima de los 1.000M")):input_ok(e),update_future(a.active?t-a.input:t)}function update_popup_send(){"remove"==$("input[name=action]").val()&&($("#btn-send").text(_("Actualizar")).removeClass("btn-red").addClass("btn-dark"),$("input[name=action]").val("update"))}$("body").on(qd_touchstart,".qd-player",function(){qd_pressed=!0,qd_element=$(this),setTimeout(function(){qd_pressed&&$.ajax({url:"ajax/qd-player",data:qd_element.data(),success:function(e){e.data.cfg=_cfg,template=twig({data:$("#twig-qd-player").text()}).render(e.data),$("#quick-dialog").html(template),qd_open()},error:function(){}})},250)}),$("body").on(qd_touchend,function(){qd_pressed=!1,qd_opened&&qd_close()}),$("body").on(qd_touchmove,function(){qd_pressed&&!qd_opened&&(qd_pressed=!1)}),$("body").on("click",".btn-fb-logout",function(){"android"==_cfg.app?MRInterface.FacebookLogout():"ios"==_cfg.app&&window.webkit.messageHandlers.FacebookLogout.postMessage(1)}),$("body").on("click",".page .btn",function(){$(".noob-alert .page").hide(),$(".noob-alert .page-"+$(this).data("goto")).show()}),$("body").on("click","#content a[href*='"+_cfg.base+"'], #sidebar a[href*='"+_cfg.base+"']",function(){"ios"!=_cfg.app&&"web_ios"!=_cfg.app&&$("#toggle-menu").append('<div class="loading"></div>').addClass("page-load")}),_cfg.active_tabs={},$("body").on("click",".tabs .tab",function(){var e=$(this),t=e.closest(".tabs"),a=t.data("panels");$(".panels-"+a+" > .panel").hide(),$(".panels-"+a+" .panel-"+e.data("tab")).show(),t.find(".tab").removeClass("active"),e.addClass("active"),"standings"==a&&("total"==e.data("tab")?sendEvent("select_general_standings"):"gameweek"==e.data("tab")&&sendEvent("select_gameweek_standings")),_cfg.active_tabs[a]=e.data("tab")}),$("body").on("click",".navbar-switch-tab",function(e){return showInterstitial("navbar-switch-tab"),!0}),$("body").on("click","#play-pool",function(){console.log("playing pool");var t=$(this);btn_lock(t);var e=$("#pool_range"),a=e.data("idcompetition"),o=e.data("idgameweek"),n=parseInt(e.val());console.log(a),console.log(o),console.log(_cfg.user.id),console.log(n),$.ajax({type:"POST",url:"/api2/pool/buypoolentry",contentType:"application/json",dataType:"json",data:JSON.stringify({competitionID:a,gameweekID:o,idUser:_cfg.user.id,step:n}),success:function(e){"OK"==e.status?(toast(_("Compra realizada")),updateCredits(_cfg.user.credits-e.spent),btn_pools.trigger("click"),popup_close()):"KO"==e.status&&"Not enough credits"==e.msg&&popup_open("credits-get",{},!1,!1)},complete:function(e){btn_unlock(t)}})}),$("body").on("click",".btn-credits",function(){var s=!1,i=$(this);btn_lock(i),$.ajax({url:"ajax/credits",data:i.data(),success:function(e){if(toast(_("Compra realizada")),updateCredits(e.data.credits),popup_close(),sendEvent("spend_virtual_currency",{sku:e.data.sku,currency:"coin"}),"change_player"==e.data.sku&&i.data("slot"))$.ajax({url:"ajax/sub-do",data:i.data(),success:function(e){callback_sub_do(e,!0)},complete:function(){btn_unlock(i)}});else if(-1<e.data.sku.indexOf("change_player"))$(".sub-list-purchase").removeClass("sub-list-purchase").addClass("sub-list-open"),$(".sub-list .btn-purchase").removeClass(".btn-purchase"),$(".sub-list .purchase").hide(),$("#live-footer .changes h2").text(e.data.subs),$(".sw-dark h2").text(e.data.subs),$(".formation .btn-sw").text(_("%s cambios",e.data.subs)),$(".sw-store .subs").text(e.data.subs),_cfg.user.changes=e.data.subs;else if(-1<e.data.sku.indexOf("add_formation_pack"))s="team?lineup=global";else if(-1<e.data.sku.indexOf("add_formation"))data.formations[i.data("formation")]="free",$.ajax({url:"ajax/formation",data:i.data(),success:function(e){"ok"==e.status&&location.replace("team?lineup=global")}});else if("remove_ads"==e.data.sku)s="feed";else if(-1<e.data.sku.indexOf("add_formation")){var t=e.data.sku.replace("add_formation_","").replace(/_/g,"-"),a="add_formation_pack"==e.data.sku?"":'[data-sku="'+e.data.sku+'"]';if($(".btn-purchase"+a).removeClass("btn-purchase").addClass("btn-free"),"pack"==t||"pack-community"==t){for(var o in $(".btn-pack").remove(),data.formations)data.formations[o]="free";$(".btn-purchase").removeClass("btn-purchase").addClass("btn-free")}else data.formations[t]="free"}else if(-1<e.data.sku.indexOf("clause")){btn_clause=$(".bottom-actions .btn-clause");var n=[1.5,2,2.5,3,3.5,4],r=parseInt(e.data.sku.replace("clause_",""))+parseInt(btn_clause.data("default"));parseInt(btn_clause.data("floor")*n[r]);btn_clause.data("multiplier",n[r]),btn_clause.data("default",r),toast(_("Cláusula modificada")),history.back()}else-1<e.data.sku.indexOf("shield")?(btn_clause=$(".bottom-actions .btn-clause"),btn_clause.text(_("Blindado")),btn_clause.data("shield",e.data.shield),toast(_("Jugador blindado")),history.back()):"rescind"==e.data.sku?(toast(_("Jugador vendido")),s="feed"):"show_bids"==e.data.sku?s="market":-1<e.data.sku.indexOf("porras_entry")?($(".porra .btn-popup").removeClass("btn-popup").addClass("btn-porra").text("Enviar resultado"),$.ajax({url:"ajax/porra",data:$("#form-porra").serialize(),success:function(e){"ok"==e.status&&toast(_("Resultado guardado"),"green")}})):"salaries"==e.data.sku&&($(".salaries .btn").removeClass("btn-popup btn-dark").addClass("btn-green").text(_("Pagado")),$(".salaries .amount").removeClass("red").addClass("paid"))},complete:function(e){e.responseJSON.popup?popup_open(e.responseJSON.popup,{},!1,!1):s&&(-1<s.indexOf("#")?window.location.hash=s:window.location.href=_cfg.base+s),btn_unlock(i)}})}),$("body").on("click",".btn-pools",function(){btn_lock(btn_pools=$(this)),$.ajax({url:"ajax/pools",data:btn_pools.data(),success:function(e){"ok"==e.status&&(btn_pools.parent().find(".btn").removeClass("mine"),btn_pools.addClass("mine"),$(".user-not-participate").addClass("user-participate").removeClass("user-not-participate"),$("p.info").text(_("Puedes realizar cambios hasta el inicio de la jornada, %s",$(".panel-results .date").first().text())))},error:function(e){void 0!==e.responseJSON.msg&&toast(_(e.responseJSON.msg),"red")},complete:function(e){e.responseJSON.popup&&(void 0!==e.responseJSON.data?popup_open(e.responseJSON.popup,e.responseJSON.data,!1,!1):popup_open(e.responseJSON.popup,{},!1,!1)),btn_unlock(btn_pools)}})}),$("body").on("click",".btn-save-prediction",function(){var e=$(this);btn_lock(e),$.ajax({url:"ajax/pools",data:$("#prediction").serialize(),success:function(e){"ok"==e.status&&toast(_("Predicción guardada"),"green")},complete:function(){btn_unlock(e)}})}),$("body").on("click",".btn-porra",function(){var e=$(this);btn_lock(e),$.ajax({url:"ajax/porra",data:$("#form-porra").serialize(),success:function(e){"ok"==e.status&&toast(_("Resultado guardado"),"green")},complete:function(){btn_unlock(e)}})}),$("body").on("click",".btn-check-porra",function(){var e=$(this),t={goals:!1,scorer:!1},a={goals_home:$("#form-porra input[name=goals_home]"),goals_away:$("#form-porra input[name=goals_away]"),id_scorer:$("#form-porra select[name=id_scorer]")};$.isNumeric(a.goals_home.val())&&$.isNumeric(a.goals_away.val())?(t.goals=!0,a.goals_home.removeClass("error"),a.goals_away.removeClass("error")):(t.goals=!1,toast(_("El resultado no es válido"),"red"),a.goals_home.addClass("error"),a.goals_away.addClass("error")),a.id_scorer.find(":selected").val()<0?(t.scorer=!1,toast(_("El goleador no es válido"),"red"),a.id_scorer.addClass("error")):(t.scorer=!0,a.id_scorer.removeClass("error")),t.goals&&t.scorer&&e.addClass("btn-popup").removeClass("btn-check-porra").trigger("click")}),$("body").on("click",".sw-store .packs .box",function(){var e,t,a=$(this).index(),o=$(this).data("sku"),n=$(this).data("promo"),r=$(this).data("extra")?"mobile":"paypal",s=$(".sw-store .packs"),i=$(".sw-store .panel-mobile"),c=$(".sw-store .panel-paypal");s.find(".box").removeClass("selected"),s.find("input").prop("checked",!1),"mobile"==r?($(this).addClass("selected").find("input").prop("checked",!0),(t=c.find(".box:eq("+a+")")).addClass("selected").find("input").prop("checked",!0),i.find(".btn-purchase").data("sku",o),i.find(".btn-purchase").data("promo",n),c.find(".btn-purchase").data("sku",t.data("sku")),c.find(".btn-purchase").data("promo",t.data("promo")),i.find(".pay-w-paypal .free-credits").text($(this).data("extra"))):($(this).addClass("selected").find("input").prop("checked",!0),(e=i.find(".box:eq("+a+")")).addClass("selected").find("input").prop("checked",!0),c.find(".btn-purchase").data("sku",o),c.find(".btn-purchase").data("promo",n),i.find(".btn-purchase").data("sku",e.data("sku")),i.find(".btn-purchase").data("promo",e.data("promo")),i.find(".pay-w-paypal .free-credits").text(e.data("extra"))),"ios"==_cfg.app&&($("#paypal-button-container").show(),$("#paypal-link-container").hide())}),$("body").on("click",".pay-w-paypal",function(){$(".panel-mobile").hide(),$(".panel-paypal").show(),$(".panel-credits .tabs").find('[data-tab="mobile"]').removeClass("active"),$(".panel-credits .tabs").find('[data-tab="paypal"]').addClass("active")}),$("body").on("click","#paypal-link-container",function(){$("#paypal-button-container").show(),$(this).hide()}),$("body").on("change","#pool-change-gw",function(){var e="pool-"+$(this).data("pool");post={post:e,id:this.value},sw_open(e,"",post)}),$("body").on("change","#salaries_moment_select",function(){var e=document.getElementById("salaries_moment_select");election=e.options[e.selectedIndex].value,ga("send",{hitType:"event",eventCategory:"salaries_moment",eventAction:"click",eventLabel:election})}),$("body").on("click",".sw-pools .panel-table a.btn",function(){var e="pool-private";post={post:e,id:$("#pool-change-gw").val(),id_uc:$(this).data("id_uc"),name:$(this).data("name")},sw_open(e,"",post)}),$("body").on("click",".btn-players-all",function(){$(this).hide(),$(this).parent().find(".btn-players-mine").show(),$(this).parent().find(".players-mine").hide(),$(this).parent().find(".players-all").css("display","flex")}),$("body").on("click",".btn-players-mine",function(){$(this).hide(),$(this).parent().find(".btn-players-all").show(),$(this).parent().find(".players-all").hide(),$(this).parent().find(".players-mine").css("display","flex")}),$("body").on("click",".btn-popup.btn-info",function(e){e.stopPropagation()}),$("body").on("input",".check-on-input",function(){eval($(this).attr("onblur"))}),"mobile"==_cfg.device&&setTimeout(function(){$(".header-top .pag-name").removeClass("show"),$(".header-top .league-name").addClass("show")},3e3),$(".sw").on("scroll",function(){0<$(".sw").scrollTop()?$(".sw-topbar").addClass("shadow"):$(".sw-topbar").removeClass("shadow")}),$(window).on("scroll",function(){var e=void 0!==_cfg.user&&_cfg.user.nav_bottom?"header .header-top, .open-header":"header, .open-header";0<$(window).scrollTop()?$(e).addClass("shadow"):$(e).removeClass("shadow")}),MutationObserver=window.MutationObserver||window.WebKitMutationObserver;var observer_input_range=new MutationObserver(function(e){$(e[0].target).find("input[type=range]").each(function(e){update_range_bg($(this).get(0))})});observer_input_range.observe(document.getElementById("popup-content"),{childList:!0});var observer_local_time=new MutationObserver(function(e){0<$(e[0].target).find(".tz").length&&local_time()});observer_local_time.observe(document.body,{childList:!0,subtree:!0});var observer_share=new MutationObserver(function(e){(void 0!==navigator.share||"undefined"!=typeof MRInterface&&void 0!==MRInterface.openShareDialog||void 0!==window.webkit&&void 0!==window.webkit.messageHandlers.openShareDialog)&&($(".btn-share").show(),$(".btn-share").parent().removeClass("no-padding"))}),giphyText;function callback_sw_gameweek(e){var t='<select id="sw-top-gw">';for(var a in e.gameweeks)t+='<option value="'+e.gameweeks[a].id+'"',e.gameweeks[a].id==e.gameweekStatus.id&&(t+=" selected"),t+=">"+e.gameweeks[a].name+"</option>";t+="</select>",$(".sw-title").html(t)}function updateBarterInputs(){var e=document.getElementsByClassName("input-amount");sumBarterPlayersValue=0;var t=$(".btn-barter").data("barter");for(var a in $("#form-bid input[name=barter]").remove(),$(".btn-barter-player").remove(),t)$('<button type="button" class="btn btn-grey btn-barter-player" data-id_player="'+t[a].id_player+'"><div class="pic"><img src="'+_cfg.pics+"img/players/"+t[a].id_player+'.png" loading="lazy"></div>'+t[a].name+'<svg><use href="'+_cfg.svg+'#remove"></use></svg></button>').insertBefore(".btn-barter"),void 0!==t[a].value&&(sumBarterPlayersValue+=parseInt(t[a].value));var o=e[0].getAttribute("data-value")-sumBarterPlayersValue;o<0&&(o=0),e[0].value=o.toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."),$("#form-bid").append('<input type="hidden" name="barter" value="'+Object.keys(t).join(",")+'">'),2<Object.keys(t).length?$(".btn-barter").hide():$(".btn-barter").show(),update_popup_send()}function addBarterPlayer(e){var t=$(".btn-barter").data("barter");t[e.id_player]=e,$(".btn-barter").data("barter",t)}function removeBarterPlayer(e){var t=$(".btn-barter").data("barter");delete t[e.id_player],$(".btn-barter").data("barter",t)}function showStoreFloatingBtn(){$("#btn-store-floating").addClass("show")}function hideStoreFloatingBtn(){$("#btn-store-floating").removeClass("show")}function updateLastSeen(){$.ajax({url:"ajax/update-last_seen",success:function(e){},error:function(){}})}observer_share.observe(document.body,{childList:!0,subtree:!0}),$("body").on("click",".btn-copy",function(){var e=$("#"+$(this).data("input"));if(-1<_cfg.app.indexOf("ios")){var t=e.get(0),a=t.contentEditable,o=t.readOnly,n=document.createRange();t.contenteditable=!0,t.readonly=!1,n.selectNodeContents(t);var r=window.getSelection();r.removeAllRanges(),r.addRange(n),t.setSelectionRange(0,999999),t.contentEditable=a,t.readOnly=o}else e.select();document.execCommand("copy"),toast(_("Enlace copiado"))}),$("body").on("click",".go-back",function(){history.length<=1?window.location=window.location.pathname:history.back()}),$("body").on("keyup",".sw-players .search input, .sw-top-search",function(){var e=$(this);data.players.name.length<1&&""===e.val()||(data.players.name=e.val(),data.players.offset=0,load_players())}),$("body").on("click",".btn-player-gw",function(e){e.preventDefault();var t=$(this);btn_lock(t),$.ajax({url:"ajax/player-gameweek",data:t.data(),success:function(e){"ok"==e.status&&popup_open("player-gameweek",e.data)},complete:function(){btn_unlock(t)}})}),$("body").on("change","#sw-top-gw",function(){post={post:"gameweek",id:this.value},sw_open("gameweek",this.options[this.selectedIndex].text,post)}),$("body").on("click",".sw-gameweek .gameweek-matches-summary .top .btn",function(){post={post:"gameweek",id:$(this).data("gw")},sw_open("gameweek",$(this).data("title"),post)}),$("body").on("click",".sw-gameweek .btn-match",function(){$(".sw").animate({scrollTop:$("#gameweek-match-"+$(this).data("match")).offset().top-72},200)}),Twig.extendFilter("keys_int",function(e){return Object.keys(e).map(Number)}),$("body").on("click",".popup-barter-players .player-avail",function(){var e=$(this);popup_back(),addBarterPlayer(e.data()),updateBarterInputs()}),$("body").on("click",".btn-barter-player",function(){removeBarterPlayer($(this).data()),updateBarterInputs()}),void 0!==_cfg.user&&updateLastSeen();var giphyLoading=!1,giphyOffset=0;function giphySearch(e,t){t=t||!1,limit=10,e=encodeURI(e),$(".giphy-results").append('<div class="loading"></div>'),delete $.ajaxSettings.headers["X-Auth"],$.ajax({url:"https://api.giphy.com/v1/gifs/search?q="+e+"&api_key=HmL1Rhx5T8GQj1FTPXuRspqYlnVNYApj&limit="+limit+"&offset="+giphyOffset+"&rating=G",type:"GET",success:function(e){t&&$(".giphy-results").empty(),e.data.forEach(function(e){$(".giphy-results").append('<div class="img" data-id="'+e.id+'"><img src="https://i.giphy.com/media/'+e.id+'/100h.gif" loading="lazy"></div>')})},complete:function(){giphyLoading=!1,$(".giphy-results .loading").remove()}}),$.ajaxSettings.headers["X-Auth"]=_cfg.auth}function shuffle(e){var t,a,o;for(o=e.length-1;0<o;o--)t=Math.floor(Math.random()*(o+1)),a=e[o],e[o]=e[t],e[t]=a;return e}function customChartTooltip(e){var t=document.getElementById("chartjs-tooltip");if(t||((t=document.createElement("div")).id="chartjs-tooltip",e.chart.canvas.parentNode.appendChild(t)),0!==e.tooltip.opacity){t.innerHTML='<div class="label">'+e.tooltip.dataPoints[0].label+"</div>",t.innerHTML+='<div class="value">'+e.tooltip.dataPoints[0].formattedValue+"</div>";var a=e.chart.canvas.offsetTop,o=e.chart.canvas.offsetLeft;t.style.opacity=1,t.style.left=o+e.tooltip.caretX+"px",t.style.top=a+e.tooltip.caretY+"px"}else t.style.opacity=0}function valuesChart(e){var t=[],a=[];e.points.forEach(function(e){t.push(e.date)}),e.points.forEach(function(e){a.push(e.value)});var o=document.getElementById("canvas").getContext("2d"),n=o.createLinearGradient(0,0,o.canvas.clientWidth,0);n.addColorStop(0,cssColors.bg_secondary),n.addColorStop(.3,cssColors.blue_medium),n.addColorStop(1,cssColors.blue_medium);var r={labels:t,datasets:[{lineTension:.5,fill:!1,pointRadius:0,pointHoverRadius:8,pointHoverBackgroundColor:cssColors.bg_secondary,pointHoverBorderColor:cssColors.blue_medium,pointHoverBorderWidth:2,borderColor:n,borderWidth:2,data:a}]};new Chart(o,{type:"line",data:r,options:{plugins:{legend:{display:!1},tooltip:{enabled:!1,external:customChartTooltip,mode:"index",axis:"x",intersect:!1}},scales:{y:{min:e.min.value,max:e.max.value,border:{display:!1},grid:{display:!1,drawBorder:!1,tickLength:0},ticks:{mirror:!0,padding:0,stepSize:e.max.value-e.min.value,color:cssColors.fg_secondary,callback:function(e){return Number(e/1e6).toFixed(1).replace(".",_cfg.locale.decimal_point)+" M"}}},x:{display:!1}},hover:{mode:"index",axis:"x",intersect:!1},animation:!1,maintainAspectRatio:!1}})}function attributesChart(e){var t=[],a=[];e.forEach(function(e){t.push(e.key),a.push(e.value)});var o=document.getElementById("canvas-attributes").getContext("2d"),n={labels:t,datasets:[{data:a,pointRadius:0,borderColor:cssColors.blue_medium,backgroundColor:cssColors.blue_medium+"44"}]};new Chart(o,{type:"radar",data:n,options:{plugins:{legend:{display:!1},tooltip:{enabled:!1}},scales:{r:{min:0,max:100,ticks:{display:!1,maxTicksLimit:5,stepSize:25},pointLabels:{display:!1},grid:{color:cssColors.bg_tertiary},angleLines:{color:cssColors.bg_tertiary}}},animation:!1,maintainAspectRatio:!1}})}function updateReceivedOffersCount(e){e.pending<1?($(".pending-offers-badge").hide(),$("li#c-"+_cfg.user.id_community+" .offers-badge").hide(),$(".market-options .offers-received").removeClass("active")):($(".pending-offers-badge").show().text(e.pending),$("li#c-"+_cfg.user.id_community+" .offers-badge").show(),$(".market-options .offers-received").addClass("active")),e.pending<1&&e.accept<1&&e.decline<1?$(".market-options .offers-received").remove():$(".market-options .offers-received .amount").text(e.pending+e.accept+e.decline)}function onRewardedVideoAdShowFailed(){}function onRewardedVideoAdEnded(){}function onRewardedVideoAdStarted(){}function onRewardedVideoAvailabilityChanged(){}function onIronInitialized(){"ios"==_cfg.app?vrIOSCall("isRewardedVideoAvailable"):MRInterface.ironSourceIsRewardedVideoAvailable()}function vrIOSCall(e){var t="iOS_IronSource_"+e,a=Array.prototype.slice.call(arguments,1);0==a.length&&a.push("");var o=window.webkit.messageHandlers[t];o.postMessage.apply(o,a)}function onRewardedVideoAvailabilityChanged(e){console.log("onRewardedVideoAvailabilityChanged",arguments),console.log(videoreward),console.log(e),videoreward&&e&&VRRewardedVideoPlacementCapped(ironVRPlacement)}function onRewardedVideoPlacementInfo(e){"string"==typeof e&&(e=JSON.parse(e));var t="rewardedAmount";"ios"==_cfg.app&&(t="rewardAmount"),document.getElementById("vr_popup_text").innerHTML=_("Consigue %s <u>gratis</u> ahora",trans("CREDITS_N",{creditsCount:e[t]})),"false"==localStorage.getItem("vr_session")?$(".vr-bottom").hide():$(".vr-bottom").show()}function VRRewardedVideoPlacementCapped(e){"ios"==_cfg.app?vrIOSCall("isRewardedVideoPlacementCapped",e):MRInterface.ironRewardedVideoPlacementCapped(e)}function onRewardedVideoPlacementCapped(e){videoreward&&(0==e?$(".vr-bottom").length&&("android"==_cfg.app?MRInterface.ironRewardedVideoPlacementInfo(ironVRPlacement):"ios"==_cfg.app&&vrIOSCall("getRewardedVideoPlacementInfo",ironVRPlacement)):$(".vr-bottom").hide()),console.log("onRewardedVideoPlacementCapped",arguments)}function onRewardedVideoAdOpened(){videoreward&&""!=ironSrcWatchToken&&$.ajax({url:"ajax/video_reward_pending",data:{token:ironSrcWatchToken},success:function(e){console.log("Reward pending")}}),console.log("onRewardedVideoAdOpened",arguments)}function onRewardedVideoAdClosed(){console.log("onRewardedVideoAdClosed",arguments);for(var e=onVRCloseQueue.length;e--;)onVRCloseQueue[e](),onVRCloseQueue.splice(e,1)}function VRWatchVideo(e,t){var a=new Date,o=(a.getMonth()+1).toString(),n=a.getDate().toString()+"/"+o+"/"+a.getFullYear().toString();localStorage.getItem("clicked_video_reward_date")&&localStorage.getItem("clicked_video_reward_date")==n||(sendEvent("clicked_video_reward_offer",{placement:t}),localStorage.setItem("clicked_video_reward_date",n)),"ios"==_cfg.app?(vrIOSCall("setRewardedVideoServerParameters",{token:e}),setTimeout(function(){vrIOSCall("showRewardedVideo",t)},100)):(MRInterface.ironRewardedVideoServerParameters(JSON.stringify({token:e})),setTimeout(function(){MRInterface.ironRewardedVideo(t)},100)),$(".vr-bottom").hide()}function ironRewardedVideo(e){videoreward&&$.ajax({url:"ajax/create_video_reward",data:{id_user:e,placement:ironVRPlacement},success:function(e){ironSrcWatchToken=String(e.data.token),placement=e.data.placement,VRWatchVideo(ironSrcWatchToken,placement)}})}function onRewardedVideoAdRewarded(){if(console.log("onRewardedVideoAdRewarded",arguments),videoreward&&(VRRewardedVideoPlacementCapped(ironVRPlacement),""!=ironSrcWatchToken)){$.ajax({url:"ajax/video_reward_watched",data:{token:ironSrcWatchToken},success:function(e){console.log("Video Reward watched")}});var e="rewardedAmount";"ios"==_cfg.app&&(e="rewardAmount"),updateCredits(_cfg.user.credits+arguments[0][e]),onVRCloseQueue.push(function(){toast(_("Créditos gratis añadidos"),"green")})}}$("body").on("click",".btn-giphy",function(){$(this).hide(),$(".giphy-content").show();var e=shuffle(["owned","deal with it","mic drop","boom","surprise","lol","facepalm","omg","wtf","haha"]);giphySearch(giphyText=e[0]),$(".giphy-results").on("scroll",function(){var e=$(".giphy-content").width();$(".giphy-results").get(0).scrollWidth-e-100<=$(".giphy-results").scrollLeft()&&!giphyLoading&&(giphyOffset+=10,giphySearch(giphyText,!(giphyLoading=!0)))})}),$("body").on("input",".giphy-input",function(){var e=$(this).val();if(e.length<2)return!1;giphyText=e,giphyOffset=0,$(".giphy-results").scrollLeft(0),$("input[name=id_giphy]").val(""),giphySearch(giphyText,!0)}),$("body").on("click",".giphy-results .img",function(){var e=$(this);e.hasClass("selected")?($(".giphy-results .img").removeClass("selected"),$("input[name=id_giphy]").val("")):($(".giphy-results .img").removeClass("selected"),e.addClass("selected"),$("input[name=id_giphy]").val(e.data("id")))}),$("body").on("click",".btn-enable-community",function(){var e=$(this);btn_lock(e),$.ajax({url:"ajax/enable-community",success:function(e){location.href=_cfg.base+"feed"},complete:function(){btn_unlock(e)}})}),$("body").on("click",".btn-reactivate-community",function(){var e=$(this);btn_lock(e),$.ajax({url:"ajax/reactivate-community",success:function(e){location.href=_cfg.base+"feed"},complete:function(){btn_unlock(e)}})}),$(document).ready(function(){if(vractive=document.getElementById("video_reward"),vractive&&(vractive=vractive.value),videoreward&&vractive)if("false"!=localStorage.getItem("vr_session")){var e=new Date,t=(e.getMonth()+1).toString(),a=e.getDate().toString()+"/"+t+"/"+e.getFullYear().toString();if("android"==_cfg.app){if("undefined"==typeof MRInterface||void 0===MRInterface.ironSetUserID)return;return MRInterface.ironSetUserID(_cfg.user.id.toString()),MRInterface.ironSourceSetConsent(!0),MRInterface.ironSourceInit(["rewardedvideo","interstitial","banner"]),void(localStorage.getItem("seen_video_reward_date")&&localStorage.getItem("seen_video_reward_date")==a||(sendEvent("seen_video_reward_offer",{placement:ironVRPlacement}),localStorage.setItem("seen_video_reward_date",a)))}if("ios"==_cfg.app){if(void 0===window.webkit||void 0===window.webkit.messageHandlers.iOS_IronSource_init)return;vrIOSCall("setUserID",_cfg.user.id.toString()),vrIOSCall("setConsent",!0),vrIOSCall("init",["rewardedvideo","interstitial","banner"]),localStorage.getItem("seen_video_reward_date")&&localStorage.getItem("seen_video_reward_date")==a||(sendEvent("seen_video_reward_offer",{placement:ironVRPlacement}),localStorage.setItem("seen_video_reward_date",a))}}else $(".vr-bottom").hide();else console.log("NO VR",videoreward,vractive)});var tutorialPopup=!1,tutorialTooltip=!1;$("body").on("click",".btn-tutorial-close",function(){var e=$(this).data("tutorial")+"_tutorial_completed";sendEvent(e),tutorialClose($(this).data("tutorial"))}),$("body").on("click",".btn-tutorial-skip",function(){var e=$(this).data("tutorial")+"_tutorial_skipped";sendEvent(e),tutorialClose($(this).data("tutorial"))}),$("body").on("click",".btn-tutorial-next",function(){var e=$(this);btn_lock(e),tutorialLoadStep(e.data("next"))});var eventsPerStep={1:"_tutorial_seen",2:"_tutorial_began"};function tutorialLoadStep(e){var t,a=tutorial.steps[e];eventsPerStep[e]&&(t=a.tutorial+eventsPerStep[e],sendEvent(t)),t=a.tutorial+"_tutorial_step",sendEvent(t,{step:e}),"popup"==a.type?(tutorialTooltip&&tutorialHideTooltip(),tutorialShowPopup(a.view)):(tutorialHidePopup(),"tooltip"==a.type&&tutorialShowTooltip(a))}function tutorialShowPopup(e){$(".tutorial-popup-content").css("max-height",.9*$(window).height()+"px");var t={cfg:_cfg,tutorial:tutorial};template=twig({href:_cfg.paths.views+"/tutorial/"+e+".twig?"+_cfg.twig,async:!0,load:function(e){output=e.render(t),tutorialPopup?($(".tutorial-popup-content").css("opacity",0),setTimeout(function(){$(".tutorial-popup-content").html(output),$(".tutorial-popup-content").css("opacity",1)},100)):($(".tutorial-popup-content").html(output),$("html").css("overflow","hidden"),$(".tutorial-overlay").css("display","flex").width(),$(".tutorial-overlay").addClass("show")),$("html").css("pointer-events","auto"),tutorialPopup=!0}})}function tutorialHidePopup(){$("html").css("overflow","").css("pointer-events","auto"),$(".tutorial-overlay").removeClass("show"),tutorialPopup=!1,setTimeout(function(){$(".tutorial-overlay").hide(),$(".tutorial-popup-content").empty()},110)}function tutorialShowTooltip(e){var t,a='<div class="tutorial-tooltip"><div class="tutorial-tooltip-bubble"><p>'+e.text+"</p>";e.button&&(e.end?a+='<button class="btn btn-white btn-tutorial-close" data-tutorial="'+e.tutorial+'">'+e.button.text+"</button>":a+='<button class="btn btn-white btn-tutorial-next" data-next="'+e.button.next+'">'+e.button.text+"</button>"),a+='</div><div class="tutorial-tooltip-arrow" data-popper-arrow></div></div>',tutorialTooltip?((t=$(".tutorial-tooltip")).removeClass("show"),$(".tutorial-tap").removeClass("show"),$(".tutorial-outline").removeClass("show"),setTimeout(function(){t.remove(),$(".tutorial-tap").remove(),$(".tutorial-outline").remove(),$("body").prepend(a),t=$(".tutorial-tooltip"),"tooltip"==e.pointer?t.find(".btn").css("pointer-events","auto"):"target"==e.pointer&&e.target.css("pointer-events","auto"),Popper.createPopper(e.target.first().get(0),t.get(0),{modifiers:[{name:"offset",options:{offset:[0,20]}}]}),tutorialTooltipExtras(e),t.addClass("show"),$(".tutorial-tap").addClass("show"),$(".tutorial-outline").addClass("show")},210)):($("body").prepend(a),t=$(".tutorial-tooltip"),$("html").css("overflow","hidden").css("pointer-events","none"),"tooltip"==e.pointer?t.find(".btn").css("pointer-events","auto"):"target"==e.pointer&&e.target.css("pointer-events","auto"),Popper.createPopper(e.target.first().get(0),t.get(0),{modifiers:[{name:"offset",options:{offset:[0,20]}}]}),tutorialTooltipExtras(e),setTimeout(function(){t.addClass("show"),$(".tutorial-tap").addClass("show"),$(".tutorial-outline").addClass("show")},100)),e.next?$("body").on("click",e.trigger,function(){tutorialLoadStep(e.next)}):e.end&&$("body").on("click",e.trigger,function(){tutorialClose(e.tutorial),e.onEndRefresh&&location.reload()}),tutorialTooltip=!0}function tutorialHideTooltip(){$("html").css("overflow","").css("pointer-events","auto"),$(".tutorial-tooltip").removeClass("show"),$(".tutorial-tap").removeClass("show"),$(".tutorial-outline").removeClass("show"),tutorialTooltip=!1,setTimeout(function(){$(".tutorial-tooltip").remove(),$(".tutorial-tap").remove(),$(".tutorial-outline").remove()},110)}function tutorialTooltipExtras(e){var t,a,o,n;if("tap"==e.hint){t=e.target.first().outerWidth(),a=e.target.first().outerHeight(),o=e.target.first().offset().top,n=e.target.first().offset().left;$("body").prepend('<div class="tutorial-tap"></div>'),$(".tutorial-tap").css("top",o+(a-50)/2+"px").css("left",n+(t-50)/2+"px")}else if("outline"==e.hint){t=e.target.first().outerWidth()+20,a=1<e.target.length?e.target.last().offset().top-e.target.first().offset().top:e.target.first().outerHeight()+20,o=e.target.first().offset().top-10,n=e.target.first().offset().left-10;$("body").prepend('<div class="tutorial-outline"></div>'),$(".tutorial-outline").css("width",t+"px").css("height",a+"px").css("top",o+"px").css("left",n+"px")}}function tutorialClose(e){var t=e+"_tutorial_seen";Cookies.set(t,1,{expires:3650,path:"/"}),tutorialHideTooltip(),tutorialHidePopup()}function svgChangeIcon(e,t){var a=e.find("svg use");if(0<a.length){var o=a.attr("href"),n=o.substring(0,o.indexOf("#"));a.attr("href",n+"#"+t)}else e.append('<svg><use href="'+_cfg.svg+"#"+t+'"></use></svg>')}function load_players(){$(".sw-content").addClass("loading"),$.ajax({url:"ajax/sw",data:data.players,success:function(a){if($(".search, .sw-top-center").removeClass("loading"),a.data.players){a.data.players.length<1?($(".sw-players .empty").show(),$("#sw-players-more").hide()):a.data.players.length<50?$("#sw-players-more").hide():($("#sw-players-more").show(),$(".sw-players .empty").hide());twig({href:_cfg.paths.views+"/ajax/players_html.twig?"+_cfg.twig,load:function(e){a.data.cfg=_cfg;var t=e.render(a.data);0<data.players.offset?$(".sw-players .player-list").append(t):$(".sw-players .player-list").html(t)}})}},complete:function(){$(".sw-content").removeClass("loading")}})}function mapFiltersAndLoad(e){var t={};for(var a in data.players.filtered=0,$("#filters-players").serializeArray().map(function(e){"on"==e.value&&(e.value=1),t[e.name]=parseInt(e.value)}),data.players.filters)data.players.filters.hasOwnProperty(a)&&void 0!==t[a]&&0!=t[a]?(data.players.filters[a]=t[a],data.players.filtered=1):data.players.filters[a]=0;data.players.filters.favs?svgChangeIcon($(".btn-show-favs"),"star-filled"):svgChangeIcon($(".btn-show-favs"),"star"),data.players.filtered?$("#btn-filter-players").addClass("active"):$("#btn-filter-players").removeClass("active"),load_players(),e&&history.back()}$(".btn-vr-close").on("click",function(e){$(".vr-bottom").hide(),localStorage.setItem("vr_session","false")}),$("body").on("click","#input-tel",function(){$("#input-range").parent().remove()}),$("body").on("click","#sw-players-more",function(){data.players.offset+=50,load_players()}),$("body").on("click",".btn-show-favs",function(){var e=$(this);0==data.players.filters.favs?(data.players.filtered=1,data.players.filters.favs=1,svgChangeIcon(e,"star-filled")):(data.players.filtered=0,data.players.filters.favs=0,svgChangeIcon(e,"star")),data.players.filtered?$("#btn-filter-players").addClass("active"):$("#btn-filter-players").removeClass("active"),data.players.offset=0,load_players()}),$("body").on("click","#btn-filters-players-apply",function(){mapFiltersAndLoad(!0)}),$("body").on("click","#btn-filters-players-reset",function(){$("#filters-players input[value=0]").prop("checked",!0),$("#filters-players input[value=-1]").prop("checked",!0),$("#filters-players select").val(0),$("#filters-players input[type=checkbox]").prop("checked",!1),mapFiltersAndLoad(!0)}),$("body").on("change","#btn-sort",function(){data.players.offset=0,data.players.order=this.value,load_players()});var search_focus=!1;function callback_sw_players(){search_focus&&($(".sw-top-search").focus(),search_focus=!1)}function thousands(e){return(e+="").replace(/[^\d-]/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,_cfg.locale.thousands_sep)}$("body").on("click",".btn-search-more",function(){sendEvent("search_players",{origin:"more"}),search_focus=!0}),$("body").on("input","#toggle-theme",function(){var e="light"==(Cookies.get("theme")||"light")?"dark":"light",t=$("#theme-css");_cfg.theme=e,Cookies.set("theme",e,{expires:3650}),t.attr("href",_cfg.themes[e])}),$("body").on("click",".btn-search-players",function(){sendEvent("select_mag",{from:_cfg.pag})}),$("body").on("click",".btn-store",function(){sendEvent("select_credits")}),$("#popup").on("input",".input-sub-add input, #input-tel",function(e,t){"input"==e.type&&update_popup_send();var a=this.selectionStart,o=this.value.length,n=this.value;$(this).val(thousands(n)),"btn"!=t&&(this.value.length<o?a--:this.value.length>o&&a++,8==e.keyCode&&n.charAt(a-1)==_cfg.locale.thousands_sep?a--:46==e.keyCode&&n.charAt(a)==_cfg.locale.thousands_sep&&a++,a=a<0?0:a,this.setSelectionRange(a,a))});var pressed=!1,speed=201;function reset_press(){pressed=!1,speed=201}var running=function(e,t,a){pressed&&(input_value(e,t,a),10==t&&(setTimeout(function(){running(e,t,a)},speed),a+=t,1<speed&&(speed-=20)))};function input_value(e,t,a){var o=$(".input-sub-add input"),n=parseInt(o.val().replace(/[^\d-]/g,"")),r="add"==e?n+a:n-a;o.val(thousands(r)),o.trigger("input",["btn"]),0<$("#input-range").length&&($("#input-range").val(r),update_range_bg($("#input-range").get(0)))}var on_touchstart="ontouchstart"in document?"touchstart":"mousedown";$("#popup").on(on_touchstart,".input-sub-add .num-sub, .input-sub-add .num-add",function(e){e.preventDefault();var t=$(this).parent().data("step"),a=$(this).parent().data("increment");update_popup_send();var o=$(this).hasClass("num-add")?"add":"sub";pressed=!0,running(o,t,a)});var on_touchend="ontouchend"in document?"touchend touchmove touchcancel":"mouseup mousemove";function update_range_bg(e){var t=(e.value-e.min)/(e.max-e.min)*100;$(e).css("background","linear-gradient(to right, "+cssColors.activeColor+" 0%, "+cssColors.activeColor+" "+t+"%, "+cssColors.bg_tertiary+" "+t+"%, "+cssColors.bg_tertiary+" 100%)")}function isTouchOutsideElement(e,t){var a=e.position().left,o=e.position().top,n=e.position().left+e.width(),r=e.position().top+e.height();return t.originalEvent.changedTouches[0].pageX<a||t.originalEvent.changedTouches[0].pageX>n||t.originalEvent.changedTouches[0].pageY<o||t.originalEvent.changedTouches[0].pageY>r}$("#popup").on(on_touchend,".input-sub-add .num-sub, .input-sub-add .num-add",function(e){"touchmove"==e.type?isTouchOutsideElement($(this),e)&&reset_press():reset_press()}),$("body").on("input","input[type=range]",function(){update_range_bg(this),update_popup_send();var e=$(this).data("update");e&&$(e).val(thousands(this.value)).trigger("input")});var ratingPrompt=$(".app-rating-prompt"),ratingPromptText,ratingPromptTextArray,ratingPromptButtons,ratingPromptInterval;function writeRatingPromptBubble(){ratingPrompt.find(".app-rating-text").text(""),ratingPrompt.find(".app-rating-buttons").removeClass("show"),setTimeout(function(){ratingPrompt.find(".app-rating-buttons").hide()},100),ratingPromptTextArray=ratingPromptText.split(/.*?/u),setTimeout(function(){ratingPromptInterval=setInterval(function(){0<ratingPromptTextArray.length?ratingPrompt.find(".app-rating-text").append(ratingPromptTextArray.shift()):(clearInterval(ratingPromptInterval),ratingPrompt.find(ratingPromptButtons).css("display","flex"),setTimeout(function(){ratingPrompt.find(ratingPromptButtons).addClass("show")},10))},30)},500)}function saveRatingClick(){$.ajax({url:"ajax/settings",data:{key:"app_rating_clicked",value:1}})}if(0<ratingPrompt.length){var ratingPromptStore="android"==_cfg.app?"Google Play":"Apple Store";ratingPromptText=_("👋 ¡Hola!        Gracias por jugar y disfrutar del fútbol con nosotros,        ¿qué opinión tienes de %s?",_cfg.brand.name),ratingPromptButtons=".app-rating-mood",setTimeout(function(){ratingPrompt.addClass("show"),writeRatingPromptBubble()},500)}$("body").on("click",".btn-app-rating",function(){var e=$(this);sendEvent("rating_"+e.data("rating")),ratingPromptButtons="good"==e.data("rating")?(ratingPromptText=_("👏 Nos alegramos de ver que estás contento con %s.        ¿Tendrías un momento para valorarnos en %s?        ¡Gracias! 😊",_cfg.brand.name,ratingPromptStore),".app-rating-good"):(ratingPromptText=_("😕 Sentimos no cumplir tus expectativas.        ¿Te importaría decirnos en qué fallamos?        ¡Gracias! 😊"),".app-rating-bad"),writeRatingPromptBubble()}),$("body").on("click",".btn-app-rating-skip",function(){Cookies.set("ask_review",1,{expires:30,path:"/"}),ratingPrompt.removeClass("show")}),$("body").on("click",".btn-app-rating-link",function(){saveRatingClick(),setTimeout(function(){ratingPrompt.removeClass("show")},500)});var scrollBoosters=[];function attachDragToScroll(){"desktop"==_cfg.device&&(scrollBoosters.forEach(function(e){e.destroy()}),document.querySelectorAll(".thin-scrollbar").forEach(function(e){scrollBoosters.push(new ScrollBooster({viewport:e,content:e,scrollMode:"native",direction:"horizontal"}))}))}$("body").on("click",".event-anchor-click",function(){var e=$(this),t=e.data("event-click-name"),a=e.data("event-params")||{};sendEvent(t,a)});var eventAnchors={};function checkVisibleEventAnchors(e){var a={top:$(window).scrollTop(),bottom:$(window).scrollTop()+$(window).height()};for(var o in a.right=null==e?(a.left=$(window).scrollLeft(),$(window).scrollLeft()+$(window).width()):(a.left=e.scrollLeft()+e.offset().left,e.scrollLeft()+e.offset().left+e.width()),eventAnchors)o>=a.top&&o<=a.bottom&&eventAnchors[o].forEach(function(e,t){!e.seen&&e.offset.left>=a.left&&e.offset.left<=a.right&&(eventAnchors[o][t].seen=!0,eventAnchors[o][t].element.get(0).dataset.seen=!0,sendEvent(e.name,e.params))})}function getOrigin(){return _cfg.brand_url}function getTeamLogo(e,t,a){t=t||20,a=a||"team-logo";var o=new Date,n=o.getFullYear()+("0"+(o.getMonth()+1)).slice(-2)+("0"+o.getDate()).slice(-2);return'<img class="'+a+'" width="'+t+'" height="'+t+'" src="'+_cfg.pics+"img/teams/"+e+".png?"+n+'" loading="lazy">'}$(".event-anchor-seen").each(function(){var e=$(this);void 0===eventAnchors[e.offset().top]&&(eventAnchors[e.offset().top]=[]),eventAnchors[e.offset().top].push({offset:{top:e.offset().top,left:e.offset().left},name:e.data("event-seen-name"),params:e.data("event-params")||{},seen:e.data("event-seen")||!1,element:e})}),$(window).on("scroll",function(){checkVisibleEventAnchors()}),Twig.extendFunction("teamLogo",function(e,t,a){return getTeamLogo(e,t,a)});var refreshTimerSecs=60,refreshTimerUpdating=!1;function refreshTimer(){if(!refreshTimerUpdating)if(1<refreshTimerSecs)refreshTimerSecs--,$(".refresh-timer").text(_("Actualización en %ss",refreshTimerSecs));else{refreshTimerUpdating=!0,$(".refresh-timer").text(_("Actualizando…"));var e={matches:[]};$(".gameweek-match").each(function(){"playing"==$(this).data("status")&&e.matches.push($(this).data("id"))}),$.ajax({url:"ajax/match-commentary",data:e,success:function(n){template=twig({href:_cfg.paths.views+"/ajax/gameweek/match-commentary.twig?"+_cfg.twig,async:!0,load:function(e){for(var t in n.data){var a=$("#gameweek-match-"+t+" .commentary-wrapper"),o={matchCommentary:n.data[t]};output=e.render(o),a.html(output)}refreshTimerUpdating=!(refreshTimerSecs=60)}})}})}}if(0<$("#sidebar").length){var slideout=new Slideout({panel:document.getElementById("content"),menu:document.getElementById("sidebar"),padding:280,tolerance:70,grabWidth:30});slideout.on("beforeopen",function(){$("#sidebar").css("display","flex"),window.location.hash="sidebar"}),slideout.on("translate",function(){$("#sidebar").css("display","flex")}),slideout.on("close",function(){$("#sidebar").hide(),$("html").removeClass("slideout-open"),"#sidebar"==window.location.hash&&history.back()})}function iOS_getToken(e){_cfg.user.tokens.indexOf(e)<0&&void 0!==e&&ntf_subscribe(e)}if($("#toggle-menu").on("click",function(){window.location.hash="sidebar"}),$("#lock").on("click",function(){history.back()}),"ios"==_cfg.app)window.webkit.messageHandlers.getToken.postMessage(1);else if("android"==_cfg.app&&void 0!==MRInterface.getFirebaseToken){var token=MRInterface.getFirebaseToken();_cfg.user.tokens.indexOf(token)<0&&void 0!==token&&ntf_subscribe(token)}function closeBottomAd(){$(".ad-bottom").remove(),document.documentElement.style.setProperty("--spacing-bottom-ad","0px")}$(".btn-close-bottom-ad").click(closeBottomAd);